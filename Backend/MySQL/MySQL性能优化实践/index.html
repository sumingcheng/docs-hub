<!doctype html><html lang=zh-CN dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Backend/MySQL/MySQL性能优化实践" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>MySQL 性能优化实践 | Sumingcheng's Document Center</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://sumingcheng.github.io/docs-hub/img/docusaurus-social-card.jpg><meta data-rh=true name=twitter:image content=https://sumingcheng.github.io/docs-hub/img/docusaurus-social-card.jpg><meta data-rh=true property=og:url content=https://sumingcheng.github.io/docs-hub/Backend/MySQL/MySQL性能优化实践><meta data-rh=true property=og:locale content=zh_CN><meta data-rh=true name=docusaurus_locale content=zh-CN><meta data-rh=true name=docsearch:language content=zh-CN><meta data-rh=true name=keywords content=素明诚,sumingcheng,技术文档,博客,前端开发,后端开发,Web开发,JavaScript,TypeScript,Vue,React,Go,Python,Java><meta data-rh=true name=author content="素明诚 (sumingcheng)"><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="MySQL 性能优化实践 | Sumingcheng's Document Center"><meta data-rh=true name=description content=查询优化><meta data-rh=true property=og:description content=查询优化><link data-rh=true rel=icon href=/docs-hub/img/favicon.ico><link data-rh=true rel=canonical href=https://sumingcheng.github.io/docs-hub/Backend/MySQL/MySQL性能优化实践><link data-rh=true rel=alternate href=https://sumingcheng.github.io/docs-hub/Backend/MySQL/MySQL性能优化实践 hreflang=zh-CN><link data-rh=true rel=alternate href=https://sumingcheng.github.io/docs-hub/Backend/MySQL/MySQL性能优化实践 hreflang=x-default><link data-rh=true rel=preconnect href=https://392UN2TOHD-dsn.algolia.net crossorigin><link rel=alternate type=application/rss+xml href=/docs-hub/blog/rss.xml title="Sumingcheng's Document Center RSS Feed"><link rel=alternate type=application/atom+xml href=/docs-hub/blog/atom.xml title="Sumingcheng's Document Center Atom Feed"><link rel=search type=application/opensearchdescription+xml title="Sumingcheng's Document Center" href=/docs-hub/opensearch.xml><script src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js async crossorigin></script><link rel=stylesheet href=/docs-hub/assets/css/styles.01c58cd0.css><script src=/docs-hub/assets/js/main.6a3f6825.js defer></script><script src=/docs-hub/assets/js/runtime~main.f39dd4dd.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label=跳到主要内容><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>跳到主要内容</a></div><nav aria-label=主导航 class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label=切换导航栏 aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/docs-hub/><div class=navbar__logo><img src=/docs-hub/img/smc.jpg alt="Sumingcheng Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs-hub/img/smc.jpg alt="Sumingcheng Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Sumingcheng</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href=/docs-hub/blog>Blog</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>Backend</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs-hub/category/基础>Go</a><li><a class=dropdown__link href=/docs-hub/category/基础-1>Python</a><li><a class=dropdown__link href=/docs-hub/category/基础-2>Java</a><li><a class=dropdown__link href=/docs-hub/Backend/Docker/Docker-基础命令>Docker</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs-hub/Backend/MySQL/常用SQL语句>MySQL</a><li><a class=dropdown__link href=/docs-hub/Backend/Redis/Redis-基础使用>Redis</a><li><a class=dropdown__link href=/docs-hub/Backend/Nginx/Nginx基础入门>Nginx</a><li><a class=dropdown__link href=/docs-hub/Backend/ElasticSearch/ElasticSearch-安装使用>ElasticSearch</a><li><a class=dropdown__link href=/docs-hub/Backend/MQ/Go-Kafka安装使用指南>MQ</a><li><a class=dropdown__link href=/docs-hub/Backend/MongoDB/MongoDB安装与使用>MongoDB</a><li><a class=dropdown__link href=/docs-hub/Backend/Git/Git-提交规范>Git</a><li><a class=dropdown__link href=/docs-hub/Backend/Regular/正则表达式基础>Regular</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>Frontend</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs-hub/category/es3-es5>JavaScript</a><li><a class=dropdown__link href=/docs-hub/Frontend/TypeScript/TypeScript简介>TypeScript</a><li><a class=dropdown__link href=/docs-hub/Frontend/Node/NodeJS基本认知>Node</a><li><a class=dropdown__link href=/docs-hub/category/vue基础入门>Vue</a><li><a class=dropdown__link href=/docs-hub/Frontend/React/初识React>React</a><li><a class=dropdown__link href=/docs-hub/Frontend/Engineering/核心-Web-指标>Engineering</a><li><a class=dropdown__link href=/docs-hub/Frontend/HTML/DOCTYPE>HTML</a><li><a class=dropdown__link href=/docs-hub/Frontend/CSS/CSS-选择器-权重-匹配规则>CSS</a><li><a class=dropdown__link href=/docs-hub/Frontend/DOM/DOM初识-JS对象-XML-幻灯片案例展示>DOM</a><li><a class=dropdown__link href=/docs-hub/Frontend/BOM/深入理解BOM>BOM</a><li><a class=dropdown__link href=/docs-hub/Frontend/Electron/初识-基础>Electron</a><li><a class=dropdown__link href=/docs-hub/Frontend/Quasar/Quasar项目搭建>Quasar</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>Interview</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs-hub/Interview/Backend/占位>Backend</a><li><a class=dropdown__link href=/docs-hub/Interview/Frontend/浏览器是如何渲染页面的>Frontend</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>Network</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs-hub/Network/AJAX/JSON基础与数据解析-JSON方法-AJAX初识>AJAX</a><li><a class=dropdown__link href=/docs-hub/Network/HTTP/URL-客户端-服务端-域名操作>HTTP</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>Web3</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs-hub/Web3/IPFS/IPFS-Desktop-运行指南>IPFS</a><li><a class=dropdown__link href=/docs-hub/Web3/Learning/Web2如何转Web3>Learning</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>Resource</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs-hub/Resource/Soft/Windows装机软件>Soft</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>Other</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs-hub/Other/CookBook/柠檬酸辣无骨鸡爪>CookBook</a><li><a class=dropdown__link href=/docs-hub/Other/Notes/使用指南>Notes</a></ul></div><a href=https://github.com/sumingcheng target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub 仓库"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title=切换浅色/暗黑模式（当前为浅色模式） aria-label=切换浅色/暗黑模式（当前为浅色模式） aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>搜索</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label=回到顶部 class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label=文档侧边栏 class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs-hub/Backend/MySQL/常用SQL语句>MySQL 常用 SQL 语句分类</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs-hub/Backend/MySQL/MySQL数据库范式>MySQL 数据库范式</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs-hub/Backend/MySQL/MySQL索引原理与优化>MySQL 索引原理与优化</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs-hub/Backend/MySQL/MySQL事务与锁机制>MySQL 事务与锁机制</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs-hub/Backend/MySQL/MySQL存储引擎详解>MySQL 存储引擎详解</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current=page href=/docs-hub/Backend/MySQL/MySQL性能优化实践>MySQL 性能优化实践</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs-hub/Backend/MySQL/MySQL主从复制与读写分离>MySQL 主从复制与读写分离</a></ul></nav><button type=button title=收起侧边栏 aria-label=收起侧边栏 class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=页面路径><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label=主页面 class=breadcrumbs__link href=/docs-hub/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>MySQL 性能优化实践</span><meta itemprop=position content=1></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>MySQL 性能优化实践</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=查询优化>查询优化<a href=#查询优化 class=hash-link aria-label=查询优化的直接链接 title=查询优化的直接链接>​</a></h2>
<p>查询优化能够显著减少执行时间并提高数据库响应速度。通过仔细分析和优化 SQL 语句，可在相同硬件条件下获得更高的查询性能。在大型用户表中添加合适索引，将用户信息按常用查询条件存放有助于快速定位结果。针对订单信息检索时，若查询频率高且条件固定，可提前设计特定索引字段减少扫描量。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=使用explain分析查询>使用<code>EXPLAIN</code>分析查询<a href=#使用explain分析查询 class=hash-link aria-label=使用explain分析查询的直接链接 title=使用explain分析查询的直接链接>​</a></h3>
<p><code>EXPLAIN</code>语句用于分析查询执行计划以识别潜在性能瓶颈。对经常访问的用户数据表执行 EXPLAIN，可发现是否使用到正确的索引或存在不必要的全表扫描。</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>EXPLAIN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> username</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> email </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> users </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> id </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>在电商系统中，对多表关联查询执行 EXPLAIN，可查看 JOIN 顺序、使用索引情况和可能的回表操作，继而针对性优化。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=避免全表扫描>避免全表扫描<a href=#避免全表扫描 class=hash-link aria-label=避免全表扫描的直接链接 title=避免全表扫描的直接链接>​</a></h3>
<p>全表扫描会在数据量巨大时降低查询性能。为提高检索订单记录的效率，预先在订单表的 user_id 字段上创建索引，查询时通过 user_id 精准定位用户订单条目，避免对整张订单表逐行检索。</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INDEX</span><span class="token plain"> idx_user_id </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> users</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">id</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>在查询订单时直接根据用户 id 定位所需记录，将响应时间从数秒降至毫秒级别。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=优化join操作>优化<code>JOIN</code>操作<a href=#优化join操作 class=hash-link aria-label=优化join操作的直接链接 title=优化join操作的直接链接>​</a></h3>
<p>多表关联查询中若未合理设置索引，JOIN 会带来额外开销。针对常用关联列添加索引，通过减少中间数据集大小降低查询延迟。在统计活跃用户订单时，对用户表和订单表的关联列 user_id 建立适当索引并确保两张表的 JOIN 条件简单清晰，可在高并发条件下依然快速返回结果。</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> u</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">username</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> o</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">order_date</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> users u</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> orders o </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> u</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">id </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> o</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">user_id</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> u</span><span class="token punctuation" style=color:#393A34>.</span><span class="token keyword" style=color:#00009f>status</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'active'</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>在用户与订单的一对多场景下，这种优化可让查询在数百万级订单数据中仍保持良好性能。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=索引优化>索引优化<a href=#索引优化 class=hash-link aria-label=索引优化的直接链接 title=索引优化的直接链接>​</a></h2>
<p>索引是提升查询性能的关键工具。针对查询需求设计与维护索引，可在大数据量场景下显著减少查询延迟。在统计用户注册数据时，为日期字段建立合适索引能更高效地检索指定日期段内的活跃用户记录。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=创建合适的索引>创建合适的索引<a href=#创建合适的索引 class=hash-link aria-label=创建合适的索引的直接链接 title=创建合适的索引的直接链接>​</a></h3>
<p>根据实际查询模式创建单列或复合索引。当按邮箱字段搜索用户信息时，在 email 字段上创建索引可加快用户资料查询速度；在搜索新注册用户时，为 status 与 created_at 字段创建复合索引，使查询直接从索引中找到目标数据行。</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INDEX</span><span class="token plain"> idx_email </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> users</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">email</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INDEX</span><span class="token plain"> idx_status_created </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> users</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>status</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> created_at</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>在用户搜索功能中，利用 idx_email 索引可瞬时返回目标用户数据。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=避免过多索引>避免过多索引<a href=#避免过多索引 class=hash-link aria-label=避免过多索引的直接链接 title=避免过多索引的直接链接>​</a></h3>
<p>索引过多会在写入更新时产生额外消耗。应对经常执行的查询精确分析，只为最常用条件创建必要索引。定期查看索引使用频率，移除冗余索引，使写性能与读性能达到良好平衡。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=使用覆盖索引>使用覆盖索引<a href=#使用覆盖索引 class=hash-link aria-label=使用覆盖索引的直接链接 title=使用覆盖索引的直接链接>​</a></h3>
<p>覆盖索引包含查询所需的所有列。对用户信息查询中仅需要 username 与 email 字段时，提前创建包含这两个字段的复合索引，使查询无需访问表数据文件即可直接从索引返回结果。</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INDEX</span><span class="token plain"> idx_username_email </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> users</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">username</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> email</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>在高并发环境中，这种方式能减少 IO 等待并提升吞吐量。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=缓存使用>缓存使用<a href=#缓存使用 class=hash-link aria-label=缓存使用的直接链接 title=缓存使用的直接链接>​</a></h2>
<p>缓存能降低数据库负载并加速数据访问。在频繁读取的配置或热门商品列表查询中，将结果缓存至内存可大幅减少后端数据库查询次数。对热门搜索关键词对应商品清单进行缓存，在高峰期访问时显著加快查询速度。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=查询缓存>查询缓存<a href=#查询缓存 class=hash-link aria-label=查询缓存的直接链接 title=查询缓存的直接链接>​</a></h3>
<p>MySQL 查询缓存在读多写少的场景下能存储查询结果并重复利用。对长期稳定不变的分类列表查询启用查询缓存，可让相同查询重复请求时直接返回缓存结果。</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">query_cache_size=64M</span><br></span><span class=token-line style=color:#393A34><span class="token plain">query_cache_type=1</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>在用户经常检索的商品分类、城市列表等低频变动的数据中，启用查询缓存效果明显。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=应用层缓存>应用层缓存<a href=#应用层缓存 class=hash-link aria-label=应用层缓存的直接链接 title=应用层缓存的直接链接>​</a></h3>
<p>通过 Redis 或 Memcached 等工具在应用层缓存结果数据，能减少对数据库的访问压力。对热门用户资料和经常访问的静态数据进行缓存，在访问应用时先查询缓存，如无数据再从数据库加载并更新缓存。</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> redis</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cache </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> redis</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Redis</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">host</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'localhost'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> port</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>6379</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> db</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">user </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> cache</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'user:1'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>not</span><span class="token plain"> user</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    user </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> get_user_from_db</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    cache</span><span class="token punctuation" style=color:#393A34>.</span><span class="token builtin">set</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'user:1'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> user</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>在社交平台关注度排行榜、新闻热点列表中可使用此策略显著降低数据库查询开销。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=配置调整>配置调整<a href=#配置调整 class=hash-link aria-label=配置调整的直接链接 title=配置调整的直接链接>​</a></h2>
<p>合理配置 MySQL 参数充分利用硬件资源。对高并发的电商订单库，适当加大缓冲池、增加最大连接数并调优日志写入参数能提高整体吞吐。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=调整缓冲池大小>调整缓冲池大小<a href=#调整缓冲池大小 class=hash-link aria-label=调整缓冲池大小的直接链接 title=调整缓冲池大小的直接链接>​</a></h3>
<p>InnoDB 缓冲池大小影响内存可缓存数据量。将 innodb_buffer_pool_size 设置为服务器可用内存的约 70%-80%，能提高热门数据的缓存命中率，减少磁盘 IO 操作，在庞大的商品和订单库中显著提升查询性能。</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">innodb_buffer_pool_size=8G</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=优化连接数>优化连接数<a href=#优化连接数 class=hash-link aria-label=优化连接数的直接链接 title=优化连接数的直接链接>​</a></h3>
<p>根据实际并发情况调整 max_connections 避免连接过多导致资源耗尽。对于中型电商网站将其设为合适值，使连接请求既不因过多占用资源，也不因过少导致访问延迟。</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">max_connections=500</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=调整日志文件大小>调整日志文件大小<a href=#调整日志文件大小 class=hash-link aria-label=调整日志文件大小的直接链接 title=调整日志文件大小的直接链接>​</a></h3>
<p>适度增大 innodb_log_file_size 减少日志写入频率，提高写入性能。对持续写入的订单、支付记录表，通过适度提升该值在保证数据安全基础上得到更好的写性能。</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">innodb_log_file_size=1G</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=硬件优化>硬件优化<a href=#硬件优化 class=hash-link aria-label=硬件优化的直接链接 title=硬件优化的直接链接>​</a></h2>
<p>硬件资源直接影响数据库性能。为追求更高性能，在访问量大且数据量庞大的业务中部署更高性能的存储与硬件配置。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=使用-ssd-存储>使用 SSD 存储<a href=#使用-ssd-存储 class=hash-link aria-label="使用 SSD 存储的直接链接" title="使用 SSD 存储的直接链接">​</a></h3>
<p>SSD 的随机读写性能优于机械硬盘，能降低数据库响应时间。将用户活跃度统计表与订单明细表存放在 SSD 上，查询延迟显著降低。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=增加内存>增加内存<a href=#增加内存 class=hash-link aria-label=增加内存的直接链接 title=增加内存的直接链接>​</a></h3>
<p>更多内存允许缓存更多数据，减少磁盘 IO 访问。当同时访问订单、用户、库存数据时，内存越充足则越能有效应对突发查询高峰。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=多核处理器>多核处理器<a href=#多核处理器 class=hash-link aria-label=多核处理器的直接链接 title=多核处理器的直接链接>​</a></h3>
<p>多核 CPU 可同时处理更多查询请求。对于短时间内大量并发查询请求，在多核环境下数据库可并行处理更多任务，提升整体吞吐。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=数据库设计优化>数据库设计优化<a href=#数据库设计优化 class=hash-link aria-label=数据库设计优化的直接链接 title=数据库设计优化的直接链接>​</a></h2>
<p>合理的数据库设计是性能优化基础。在查询用户行为、订单统计时，优雅的数据结构有利于快速检索与聚合操作，减少不必要的表扫描与关联。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=规范化与反规范化>规范化与反规范化<a href=#规范化与反规范化 class=hash-link aria-label=规范化与反规范化的直接链接 title=规范化与反规范化的直接链接>​</a></h3>
<p>通过规范化减轻数据冗余，利用反规范化在特定场景下减少关联查询次数，提升性能。在报表分析场景中，事先将合并的统计数据存储于单表中，无需多次 JOIN 即可快速返回结果。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=合理的数据类型>合理的数据类型<a href=#合理的数据类型 class=hash-link aria-label=合理的数据类型的直接链接 title=合理的数据类型的直接链接>​</a></h3>
<p>选择正确的数据类型缩减存储空间与比较开销。在存放价格、数量等数据时，使用合适精度的 DECIMAL 类型既满足精度要求又避免空间浪费。</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> products </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    id </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AUTO_INCREMENT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>PRIMARY</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>KEY</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    name </span><span class="token keyword" style=color:#00009f>VARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>100</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    price </span><span class="token keyword" style=color:#00009f>DECIMAL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ENGINE</span><span class="token operator" style=color:#393A34>=</span><span class="token keyword" style=color:#00009f>InnoDB</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=分区表>分区表<a href=#分区表 class=hash-link aria-label=分区表的直接链接 title=分区表的直接链接>​</a></h3>
<p>对巨大表进行分区可提升查询性能与维护效率。将销售记录按年份分区后，查询特定年份数据时仅需访问对应分区，减少不必要的数据扫描。</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> sales </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    id </span><span class="token keyword" style=color:#00009f>INT</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    sale_date </span><span class="token keyword" style=color:#00009f>DATE</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    amount </span><span class="token keyword" style=color:#00009f>DECIMAL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ENGINE</span><span class="token operator" style=color:#393A34>=</span><span class="token keyword" style=color:#00009f>InnoDB</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>PARTITION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BY</span><span class="token plain"> RANGE </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>YEAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">sale_date</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>PARTITION</span><span class="token plain"> p0 </span><span class="token keyword" style=color:#00009f>VALUES</span><span class="token plain"> LESS THAN </span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1991</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>PARTITION</span><span class="token plain"> p1 </span><span class="token keyword" style=color:#00009f>VALUES</span><span class="token plain"> LESS THAN </span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1995</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>PARTITION</span><span class="token plain"> p2 </span><span class="token keyword" style=color:#00009f>VALUES</span><span class="token plain"> LESS THAN </span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1999</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>PARTITION</span><span class="token plain"> p3 </span><span class="token keyword" style=color:#00009f>VALUES</span><span class="token plain"> LESS THAN MAXVALUE</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>在分析特定时间段内的销售数据时，通过访问对应分区可显著降低查询时间。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=使用explain优化查询>使用<code>EXPLAIN</code>优化查询<a href=#使用explain优化查询 class=hash-link aria-label=使用explain优化查询的直接链接 title=使用explain优化查询的直接链接>​</a></h2>
<p><code>EXPLAIN</code>可显示查询执行计划。通过分析访问类型、可能使用的索引及实际执行顺序，可指导优化策略。在订单与用户表关联查询中查看 EXPLAIN 结果，有助于根据返回的信息判断是否需要调整索引或改变查询结构。</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>EXPLAIN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> u</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">username</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> o</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">order_date</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> users u</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> orders o </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> u</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">id </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> o</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">user_id</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> u</span><span class="token punctuation" style=color:#393A34>.</span><span class="token keyword" style=color:#00009f>status</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'active'</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>根据 EXPLAIN 信息调整索引列顺序或添加缺失索引后，再次执行查询可显著减少扫描行数，缩短执行时间。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=监控和分析工具>监控和分析工具<a href=#监控和分析工具 class=hash-link aria-label=监控和分析工具的直接链接 title=监控和分析工具的直接链接>​</a></h2>
<p>利用监控与分析工具可持续跟踪数据库性能。对访问量波动较大的系统定期检查慢查询日志或借助第三方工具发现潜在瓶颈，提前进行优化。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=mysql-慢查询日志>MySQL 慢查询日志<a href=#mysql-慢查询日志 class=hash-link aria-label="MySQL 慢查询日志的直接链接" title="MySQL 慢查询日志的直接链接">​</a></h3>
<p>启用慢查询日志并设置阈值，记录超过指定执行时间的查询。根据慢查询日志中出现频率高的 SQL 语句，重点分析执行计划并进行针对性优化，可减少查询响应时间。</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">slow_query_log=1</span><br></span><span class=token-line style=color:#393A34><span class="token plain">slow_query_log_file=/var/log/mysql/slow.log</span><br></span><span class=token-line style=color:#393A34><span class="token plain">long_query_time=2</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>在用户订单查询长期缓慢的情况下，通过慢查询日志找到导致问题的 SQL，并为其添加合适索引或调整数据结构。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=percona-toolkit>Percona Toolkit<a href=#percona-toolkit class=hash-link aria-label="Percona Toolkit的直接链接" title="Percona Toolkit的直接链接">​</a></h3>
<p>Percona Toolkit 提供丰富的管理与分析工具，协助进行数据同步校验、查询分析与表结构优化。在频繁变动的数据环境中可通过该工具监控指标与性能变化，快速定位异常查询。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=mysql-workbench>MySQL Workbench<a href=#mysql-workbench class=hash-link aria-label="MySQL Workbench的直接链接" title="MySQL Workbench的直接链接">​</a></h3>
<p>MySQL Workbench 提供可视化界面，易于查看结构、执行查询和监控性能。通过该工具可在数据量激增前提前发现潜在瓶颈，并在问题显现前完成优化。</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/sumingcheng/docs-hub/edit/main/docs/Backend/MySQL/60.MySQL性能优化实践.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated>最后<!-- -->由 <b>sumingcheng</b> <!-- -->于 <b><time datetime=2024-12-17T02:24:03.000Z itemprop=dateModified>2024年12月17日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label=文件选项卡><a class="pagination-nav__link pagination-nav__link--prev" href=/docs-hub/Backend/MySQL/MySQL存储引擎详解><div class=pagination-nav__sublabel>上一页</div><div class=pagination-nav__label>MySQL 存储引擎详解</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs-hub/Backend/MySQL/MySQL主从复制与读写分离><div class=pagination-nav__sublabel>下一页</div><div class=pagination-nav__label>MySQL 主从复制与读写分离</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#查询优化 class="table-of-contents__link toc-highlight">查询优化</a><ul><li><a href=#使用explain分析查询 class="table-of-contents__link toc-highlight">使用<code>EXPLAIN</code>分析查询</a><li><a href=#避免全表扫描 class="table-of-contents__link toc-highlight">避免全表扫描</a><li><a href=#优化join操作 class="table-of-contents__link toc-highlight">优化<code>JOIN</code>操作</a></ul><li><a href=#索引优化 class="table-of-contents__link toc-highlight">索引优化</a><ul><li><a href=#创建合适的索引 class="table-of-contents__link toc-highlight">创建合适的索引</a><li><a href=#避免过多索引 class="table-of-contents__link toc-highlight">避免过多索引</a><li><a href=#使用覆盖索引 class="table-of-contents__link toc-highlight">使用覆盖索引</a></ul><li><a href=#缓存使用 class="table-of-contents__link toc-highlight">缓存使用</a><ul><li><a href=#查询缓存 class="table-of-contents__link toc-highlight">查询缓存</a><li><a href=#应用层缓存 class="table-of-contents__link toc-highlight">应用层缓存</a></ul><li><a href=#配置调整 class="table-of-contents__link toc-highlight">配置调整</a><ul><li><a href=#调整缓冲池大小 class="table-of-contents__link toc-highlight">调整缓冲池大小</a><li><a href=#优化连接数 class="table-of-contents__link toc-highlight">优化连接数</a><li><a href=#调整日志文件大小 class="table-of-contents__link toc-highlight">调整日志文件大小</a></ul><li><a href=#硬件优化 class="table-of-contents__link toc-highlight">硬件优化</a><ul><li><a href=#使用-ssd-存储 class="table-of-contents__link toc-highlight">使用 SSD 存储</a><li><a href=#增加内存 class="table-of-contents__link toc-highlight">增加内存</a><li><a href=#多核处理器 class="table-of-contents__link toc-highlight">多核处理器</a></ul><li><a href=#数据库设计优化 class="table-of-contents__link toc-highlight">数据库设计优化</a><ul><li><a href=#规范化与反规范化 class="table-of-contents__link toc-highlight">规范化与反规范化</a><li><a href=#合理的数据类型 class="table-of-contents__link toc-highlight">合理的数据类型</a><li><a href=#分区表 class="table-of-contents__link toc-highlight">分区表</a></ul><li><a href=#使用explain优化查询 class="table-of-contents__link toc-highlight">使用<code>EXPLAIN</code>优化查询</a><li><a href=#监控和分析工具 class="table-of-contents__link toc-highlight">监控和分析工具</a><ul><li><a href=#mysql-慢查询日志 class="table-of-contents__link toc-highlight">MySQL 慢查询日志</a><li><a href=#percona-toolkit class="table-of-contents__link toc-highlight">Percona Toolkit</a><li><a href=#mysql-workbench class="table-of-contents__link toc-highlight">MySQL Workbench</a></ul></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>LinkExchange</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://leviatan.cn target=_blank rel="noopener noreferrer" class=footer__link-item>Leviatan<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>Acknowledgments</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://react.dev target=_blank rel="noopener noreferrer" class=footer__link-item>React<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://docusaurus.io target=_blank rel="noopener noreferrer" class=footer__link-item>Docusaurus<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>More</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://sumingcheng.cn target=_blank rel="noopener noreferrer" class=footer__link-item>Blog<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://github.com/sumingcheng target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2020-2024 Sumingcheng. All Rights Reserved.</div></div></div></footer></div>