"use strict";(self.webpackChunknote_book=self.webpackChunknote_book||[]).push([["25868"],{77760:function(n,e,a){a.r(e),a.d(e,{default:()=>u,frontMatter:()=>o,metadata:()=>t,assets:()=>d,toc:()=>c,contentTitle:()=>i});var t=JSON.parse('{"id":"Frontend/Vue/Vue\u8FDB\u9636\u7279\u6027/\u6570\u636E\u52AB\u6301\u6E90\u7801","title":"\u5B9E\u73B0 Vue2.0 \u6570\u636E\u52AB\u6301","description":"vue.js","source":"@site/docs/Frontend/Vue/Vue\u8FDB\u9636\u7279\u6027/40.\u6570\u636E\u52AB\u6301\u6E90\u7801.md","sourceDirName":"Frontend/Vue/Vue\u8FDB\u9636\u7279\u6027","slug":"/Frontend/Vue/Vue\u8FDB\u9636\u7279\u6027/\u6570\u636E\u52AB\u6301\u6E90\u7801","permalink":"/docs-hub/Frontend/Vue/Vue\u8FDB\u9636\u7279\u6027/\u6570\u636E\u52AB\u6301\u6E90\u7801","draft":false,"unlisted":false,"editUrl":"https://github.com/sumingcheng/docs-hub/edit/main/docs/Frontend/Vue/Vue\u8FDB\u9636\u7279\u6027/40.\u6570\u636E\u52AB\u6301\u6E90\u7801.md","tags":[],"version":"current","lastUpdatedBy":"sumingcheng","lastUpdatedAt":1739167030000,"sidebarPosition":40,"frontMatter":{},"sidebar":"vueSidebar","previous":{"title":"\u5E94\u7528\u5B9E\u4F8B","permalink":"/docs-hub/Frontend/Vue/Vue\u8FDB\u9636\u7279\u6027/\u5E94\u7528\u5B9E\u4F8B-\u7EC4\u4EF6\u5B9E\u4F8B\u4E0E\u6839\u7EC4\u4EF6\u5B9E\u4F8B"},"next":{"title":"\u89C2\u5BDF\u8005\u6A21\u5F0F","permalink":"/docs-hub/Frontend/Vue/Vue\u8FDB\u9636\u7279\u6027/\u89C2\u5BDF\u8005\u548C\u53D1\u5E03\u8BA2\u9605"}}'),r=a("85893"),s=a("50065");let o={},i="\u5B9E\u73B0 Vue2.0 \u6570\u636E\u52AB\u6301",d={},c=[{value:"vue.js",id:"vuejs",level:2},{value:"initState.js",id:"initstatejs",level:2},{value:"proxyData.js",id:"proxydatajs",level:2},{value:"observe.js",id:"observejs",level:2},{value:"observer.js",id:"observerjs",level:2},{value:"reactive.js",id:"reactivejs",level:2},{value:"array.js",id:"arrayjs",level:2},{value:"config.js",id:"configjs",level:2},{value:"observeArr.js",id:"observearrjs",level:2}];function l(n){let e={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,s.a)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"\u5B9E\u73B0-vue20-\u6570\u636E\u52AB\u6301",children:"\u5B9E\u73B0 Vue2.0 \u6570\u636E\u52AB\u6301"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"import Vue from './vue.js';\n\nconst vm = new Vue({\n  el: '#app',\n  data() {\n    return {\n      a: 1,\n      b: 2,\n      studentList: [3, 4, 5, 6, 7],\n      info: {\n        a: {\n          b: 1,\n        },\n      },\n      obj: [\n        {\n          id: 8,\n          name: 'Tom',\n          age: 28,\n        },\n        {\n          id: 9,\n          name: 'Jack',\n          age: 29,\n        },\n        {\n          id: 10,\n          name: 'Jack',\n          age: 30,\n        },\n      ],\n    };\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"vuejs",children:"vue.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"import { initState } from './initState.js';\n\n/**\n * Vue\u6784\u9020\u51FD\u6570\n * @param {*} options \u914D\u7F6E\u9879\n */\nfunction Vue(options) {\n  // \u5224\u65AD\u5F53\u524D\u914D\u7F6E\u9879\u7684\u7C7B\u578B\uFF0C\u5982\u679C\u7C7B\u578B\u4E0D\u5339\u914D\u5219\u8FD4\u56DE\n  if (typeof options !== 'object' || options === null) return;\n  // Vue\u521D\u59CB\u5316\u51FD\u6570\n  this._init(options);\n}\n\nVue.prototype._init = function (options) {\n  // \u5B9E\u4F8B\u5316\u5BF9\u8C61\n  const vm = this;\n  // options\u914D\u7F6E\u9879\u6302\u8F7D\u5230\u5B9E\u4F8B\u5BF9\u8C61\u4E2D\n  this.$options = options;\n  // \u521D\u59CB\u5316\u5B9E\u4F8B\u5BF9\u8C61\u7684\u72B6\u6001\n  initState(vm);\n};\n\nexport default Vue;\n"})}),"\n",(0,r.jsx)(e.h2,{id:"initstatejs",children:"initState.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"// \u6570\u636E\u52AB\u6301\u7ED1\u5B9A\nimport proxyData from './proxyData.js';\n// \u6570\u636E\u89C2\u5BDF\nimport observe from './observe.js';\n\nfunction initState(vm) {\n  // \u83B7\u53D6\u5B9E\u4F8B\u5BF9\u8C61\u4E0A\u7684$options\u5C5E\u6027\n  const option = vm.$options;\n  // \u5224\u65AD$options\u5C5E\u6027\u4E2D\u662F\u5426\u5B58\u5728data\u5C5E\u6027\n  if (option.data) {\n    // \u5982\u679C\u5B58\u5728data\u5C5E\u6027\uFF0C\u6267\u884C\u521D\u59CB\u5316data\u65B9\u6CD5\n    initData(vm);\n  }\n}\n\nfunction initData(vm) {\n  // \u83B7\u53D6\u5B9E\u4F8B\u5BF9\u8C61\u7684data\u5C5E\u6027\n  let data = vm.$options.data;\n  // \u5728\u5B9E\u4F8B\u5BF9\u8C61\u6302\u8F7D_data\u5C5E\u6027\uFF0C\u662Fdata\u5C5E\u6027\u6267\u884C\u540E\u7684\u8FD4\u56DE\u503C;\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data || {};\n  // \u901A\u8FC7\u6570\u636E\u52AB\u6301\u7684\u65B9\u5F0F\u5904\u7406vm.a\u3001vm.b\u53EF\u4EE5\u76F4\u63A5\u83B7\u53D6\u503C\u7684\u9700\u6C42;\n  for (const key in data) {\n    // \u8BBE\u7F6E\u4EE3\u7406\u6570\u636E\u7684\u65B9\u6CD5\n    proxyData(vm, '_data', key);\n  }\n  // \u8FDB\u884C\u5B8C\u6570\u636E\u7ED1\u5B9A\u540E\uFF0C\u9700\u8981\u89C2\u5BDFdata\u6570\u636E\u7684\u66F4\u65B0\n  observe(data);\n}\n\nexport { initState };\n"})}),"\n",(0,r.jsx)(e.h2,{id:"proxydatajs",children:"proxyData.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"/**\n * @param {*} vm \u5B9E\u4F8B\u5316\u5BF9\u8C61\n * @param {*} target \u76EE\u6807\u5BF9\u8C61\u5C5E\u6027\n * @param {*} key \u5BF9\u8C61\u952E\u540D\n */\nfunction proxyData(vm, target, key) {\n  // \u6570\u636E\u52AB\u6301\u7ED1\u5B9A\n  Object.defineProperty(vm, key, {\n    get() {\n      // vm.a ---\x3e vm['_data']['a'];\n      return vm[target][key];\n    },\n    set(newValue) {\n      // vm.a = 3 --\x3e vm['_data']['a'] = 3;\n      if (newValue === vm[target][key]) return;\n      vm[target][key] = newValue;\n    },\n  });\n}\n\nexport default proxyData;\n"})}),"\n",(0,r.jsx)(e.h2,{id:"observejs",children:"observe.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"// \u5F15\u5165\u89C2\u5BDF\u8005\nimport Observer from './observer.js';\n\n/**\n * @param {*} data vm._data\u5C5E\u6027\n */\nfunction observe(data) {\n  // \u5224\u65ADvm.data\u5C5E\u6027\u7C7B\u578B\n  if (typeof data !== 'object' || data === null) return;\n  // \u8BBE\u7F6E\u89C2\u5BDF\u8005\u5B9E\u4F8B\u5BF9\u8C61\n  return new Observer(data);\n}\n\nexport default observe;\n"})}),"\n",(0,r.jsx)(e.h2,{id:"observerjs",children:"observer.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"// \u5F15\u5165\u6570\u636E\u54CD\u5E94\u5F0F\u7684\u65B9\u6CD5\nimport { defineReactiveData } from './reactive.js';\n// \u5F15\u5165\u6570\u7EC4\u5904\u7406\u65B9\u6CD5\nimport { arrMethods } from './array';\nimport observeArr from './observeArr';\n\n/**\n * @param {*} data vm._data\n */\nfunction Observer(data) {\n  // \u5224\u65ADvm._data\u5C5E\u6027\u7C7B\u578B\u662F\u6570\u7EC4\u8FD8\u662F\u5BF9\u8C61;\n  if (Array.isArray(data)) {\n    data.__proto__ = arrMethods;\n    observeArr(data);\n  } else {\n    // \u662F\u5BF9\u8C61\uFF0C\u6267\u884Cwalk\u65B9\u6CD5;\n    this.walk(data);\n  }\n}\n\nObserver.prototype.walk = function (data) {\n  // \u83B7\u53D6vm._data\u5BF9\u8C61\u7684\u53EF\u679A\u4E3E\u952E\u540D keys --\x3e ['a', 'b', 'students', 'obj']\n  const keys = Object.keys(data);\n  // \u5FAA\u73AF\u904D\u5386keys\u6570\u7EC4\n  for (let i = 0; i < keys.length; i++) {\n    // \u83B7\u53D6vm._data\u5BF9\u8C61\u7684\u952E\u540D\u548C\u952E\u503C;\n    const key = keys[i];\n    const value = data[key];\n    // \u6267\u884C\u6570\u636E\u54CD\u5E94\u5F0F\u7684\u65B9\u6CD5\n    defineReactiveData(data, key, value);\n  }\n};\n\nexport default Observer;\n"})}),"\n",(0,r.jsx)(e.h2,{id:"reactivejs",children:"reactive.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"function defineReactiveData(data, key, value) {\n  // \u5B58\u5728\u7684\u95EE\u9898\uFF1A\u6B64\u65F6value\u53EF\u80FD\u8FD8\u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u6216\u8005\u662F\u6570\u7EC4\n  // \u9012\u5F52\u89C2\u5BDF\n  observe(value);\n\n  // \u6570\u636E\u52AB\u6301\n  Object.defineProperty(data, key, {\n    get() {\n      console.log('\u54CD\u5E94\u5F0F\u6570\u636E: \u83B7\u53D6', value);\n      return value;\n    },\n    set(newValue) {\n      console.log('\u54CD\u5E94\u5F0F\u8BBE\u7F6E: \u8BBE\u7F6E', newValue);\n      if (newValue === value) return;\n      // \u9012\u5F52\u89C2\u5BDF\n      observe(newValue);\n      value = newValue;\n    },\n  });\n}\n\nexport { defineReactiveData };\n"})}),"\n",(0,r.jsx)(e.h2,{id:"arrayjs",children:"array.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"// \u5F15\u5165\u66F4\u6539\u539F\u6570\u7EC4\u65B9\u6CD5\u7684\u914D\u7F6E\u5BF9\u8C61\nimport { ARR_METHODS } from './config';\n// \u5F15\u5165\u89C2\u5BDF\u6570\u7EC4\u7684\u65B9\u6CD5\nimport observeArr from './observeArr.js';\n\nconst originArrMethods = Array.prototype;\nconst arrMethods = Object.create(originArrMethods);\n\nARR_METHODS.forEach(function (m) {\n  // \u539F\u6570\u7EC4\u7684\u57FA\u7840\u4E0A\u5305\u88F9\u4E00\u5C42\u51FD\u6570\uFF0C\u76EE\u7684\u662F\u6267\u884C\u539F\u6709\u51FD\u6570\u540E\u8FD8\u80FD\u591F\u6267\u884C\u5176\u4ED6\u903B\u8F91;\n  arrMethods[m] = function () {\n    const args = Array.prototype.slice.call(arguments);\n    // \u6267\u884C\u539F\u6709\u7684\u6570\u7EC4\u65B9\u6CD5\n    const rt = originArrMethods[m].apply(this, args);\n\n    // \u6267\u884C\u5176\u4ED6\u903B\u8F91\n    let newArr;\n    switch (m) {\n      case 'push':\n      case 'unshift':\n        newArr = args;\n        break;\n      case 'splice':\n        newArr = args.slice(2);\n        break;\n      default:\n        break;\n    }\n    newArr && observeArr(newArr);\n    return rt;\n  };\n});\n\nexport { arrMethods };\n"})}),"\n",(0,r.jsx)(e.h2,{id:"configjs",children:"config.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"const ARR_METHODS = ['push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse'];\n"})}),"\n",(0,r.jsx)(e.h2,{id:"observearrjs",children:"observeArr.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"// \u5F15\u5165observe\u89C2\u5BDF\u7684\u65B9\u6CD5\nimport observe from './observe';\n\nfunction observeArr(arr) {\n  for (let i = 0; i < arr.length; i++) {\n    observe(arr[i]);\n  }\n}\n\nexport default observeArr;\n"})})]})}function u(n={}){let{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(l,{...n})}):l(n)}},50065:function(n,e,a){a.d(e,{Z:function(){return i},a:function(){return o}});var t=a(67294);let r={},s=t.createContext(r);function o(n){let e=t.useContext(s);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:o(n.components),t.createElement(s.Provider,{value:e},n.children)}}}]);