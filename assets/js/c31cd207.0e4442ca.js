"use strict";(self.webpackChunknote_book=self.webpackChunknote_book||[]).push([["50742"],{75320:function(n,t,e){e.r(t),e.d(t,{assets:function(){return l},contentTitle:function(){return i},default:function(){return c},frontMatter:function(){return s},metadata:function(){return r},toc:function(){return u}});var r=e(37660),a=e(85893),o=e(50065);let s={slug:"go-gin-\u5C01\u88C5-translations-\u63D2\u4EF6",title:"Go Gin \u5C01\u88C5 translations \u63D2\u4EF6",authors:["sumingcheng"],tags:["backend"],date:new Date("2024-07-17T00:00:00.000Z")},i="Go Gin \u5C01\u88C5 translations \u63D2\u4EF6",l={authorsImageUrls:[void 0]},u=[{value:"translate.go",id:"translatego",level:2},{value:"Login.go",id:"logingo",level:3}];function g(n){let t={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.a)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"translatego",children:"translate.go"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:'package util\n\nimport (\n	"errors"\n	"fmt"\n	"github.com/gin-gonic/gin/binding"\n	"github.com/go-playground/locales/en"\n	"github.com/go-playground/locales/zh"\n	ut "github.com/go-playground/universal-translator"\n	"github.com/go-playground/validator/v10"\n	enTranslations "github.com/go-playground/validator/v10/translations/en"\n	chTranslations "github.com/go-playground/validator/v10/translations/zh"\n	"strings"\n)\n\nvar trans ut.Translator\n\nfunc init() {\n	if err := transInit("zh"); err != nil {\n		LogRus.Fatal("Failed to initialize translator:", err)\n	}\n}\n\nfunc transInit(locale string) error {\n	if v, ok := binding.Validator.Engine().(*validator.Validate); ok {\n		zhT := zh.New()              // Chinese translator\n		enT := en.New()              // English translator\n		uni := ut.New(enT, zhT, enT) // Universal translator\n\n		var ok bool\n		trans, ok = uni.GetTranslator(locale)\n		if !ok {\n			return fmt.Errorf("uni.GetTranslator(%s) failed", locale)\n		}\n\n		// Register translation based on locale\n		switch locale {\n		case "zh":\n			return chTranslations.RegisterDefaultTranslations(v, trans)\n		case "en":\n			return enTranslations.RegisterDefaultTranslations(v, trans)\n		default:\n			return enTranslations.RegisterDefaultTranslations(v, trans)\n		}\n	}\n\n	return fmt.Errorf("failed to assert Validator")\n}\n\nfunc TranslateErrors(err error) string {\n	var errs validator.ValidationErrors\n	if errors.As(err, &errs) {\n		var errMessages []string\n		for _, e := range errs {\n			translatedMsg := e.Translate(trans)\n			errMessages = append(errMessages, translatedMsg)\n		}\n		return strings.Join(errMessages, ", ")\n	}\n	return err.Error()\n}\n\n'})}),"\n",(0,a.jsx)(t.h3,{id:"logingo",children:"Login.go"}),"\n",(0,a.jsx)(t.p,{children:"\u76F4\u63A5\u4F7F\u7528\u5C01\u88C5\u597D\u7684 TranslateErrors \u8FDB\u884C\u7FFB\u8BD1"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"func Login(ctx *gin.Context) {\n	// \u672A\u767B\u5F55\uFF0C\u767B\u5F55\u6D41\u7A0B\n	var req LoginRequest\n	if err := ctx.ShouldBindJSON(&req); err != nil {\n		ctx.JSON(http.StatusBadRequest, LoginResponse{Code: 1, Msg: util.TranslateErrors(err)})\n		return\n	}\n}\n"})})]})}function c(n={}){let{wrapper:t}={...(0,o.a)(),...n.components};return t?(0,a.jsx)(t,{...n,children:(0,a.jsx)(g,{...n})}):g(n)}},50065:function(n,t,e){e.d(t,{Z:function(){return i},a:function(){return s}});var r=e(67294);let a={},o=r.createContext(a);function s(n){let t=r.useContext(o);return r.useMemo(function(){return"function"==typeof n?n(t):{...t,...n}},[t,n])}function i(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:s(n.components),r.createElement(o.Provider,{value:t},n.children)}},37660:function(n){n.exports=JSON.parse('{"permalink":"/docs-hub/blog/go-gin-\u5C01\u88C5-translations-\u63D2\u4EF6","editUrl":"https://github.com/sumingcheng/docs-hub/blog/\u540E\u7AEF/2024-07-17-Go_Gin_\u5C01\u88C5_translations_\u63D2\u4EF6.md","source":"@site/blog/\u540E\u7AEF/2024-07-17-Go_Gin_\u5C01\u88C5_translations_\u63D2\u4EF6.md","title":"Go Gin \u5C01\u88C5 translations \u63D2\u4EF6","description":"translate.go","date":"2024-07-17T00:00:00.000Z","tags":[{"inline":false,"label":"\u540E\u7AEF","permalink":"/docs-hub/blog/tags/backend","description":"\u540E\u7AEF\u5F00\u53D1\u6280\u672F\u6587\u7AE0"}],"readingTime":0.6866666666666666,"hasTruncateMarker":false,"authors":[{"name":"\u7D20\u660E\u8BDA","title":"Full stack development","url":"https://github.com/sumingcheng","page":{"permalink":"/docs-hub/blog/authors/sumingcheng"},"socials":{"x":"https://x.com/sumingcheng","github":"https://github.com/sumingcheng"},"imageURL":"https://github.com/user-attachments/assets/9a06bd55-094a-4efc-91c3-d1b92236822f","key":"sumingcheng"}],"frontMatter":{"slug":"go-gin-\u5C01\u88C5-translations-\u63D2\u4EF6","title":"Go Gin \u5C01\u88C5 translations \u63D2\u4EF6","authors":["sumingcheng"],"tags":["backend"],"date":"2024-07-17T00:00:00.000Z"},"unlisted":false,"prevItem":{"title":"Axios \u72B6\u6001\u7801\u5904\u7406\u8303\u56F4","permalink":"/docs-hub/blog/axios-\u72B6\u6001\u7801\u5904\u7406\u8303\u56F4"},"nextItem":{"title":"\u5982\u4F55\u4E0A\u4F20\u955C\u50CF\u5230 Docker Hub","permalink":"/docs-hub/blog/\u5982\u4F55\u4E0A\u4F20\u955C\u50CF\u5230-docker-hub"}}')}}]);