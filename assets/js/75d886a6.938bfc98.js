"use strict";(self.webpackChunknote_book=self.webpackChunknote_book||[]).push([["94265"],{41320:function(e,n,s){s.r(n),s.d(n,{assets:function(){return t},contentTitle:function(){return r},default:function(){return p},frontMatter:function(){return c},metadata:function(){return i},toc:function(){return o}});var i=s(30282),l=s(85893),d=s(50065);let c={slug:"whispercpp-\u5B89\u88C5\u4E0E\u4F7F\u7528\u6559\u7A0B",title:"Whispercpp \u5B89\u88C5\u4E0E\u4F7F\u7528\u6559\u7A0B",authors:["sumingcheng"],tags:["dev-tools"],date:new Date("2024-10-27T00:00:00.000Z")},r="Whisper.cpp \u5B89\u88C5\u4E0E\u4F7F\u7528\u6559\u7A0B",t={authorsImageUrls:[void 0]},o=[{value:"\u73AF\u5883\u51C6\u5907",id:"\u73AF\u5883\u51C6\u5907",level:2},{value:"\u5B89\u88C5\u7F16\u8BD1\u5DE5\u5177",id:"\u5B89\u88C5\u7F16\u8BD1\u5DE5\u5177",level:2},{value:"\u4E0B\u8F7D\u4E0E\u7F16\u8BD1 Whisper.cpp",id:"\u4E0B\u8F7D\u4E0E\u7F16\u8BD1-whispercpp",level:2},{value:"\u7F16\u8BD1\u9879\u76EE",id:"\u7F16\u8BD1\u9879\u76EE",level:2},{value:"\u4F7F\u7528 Whisper \u8FDB\u884C\u8BED\u97F3\u8BC6\u522B",id:"\u4F7F\u7528-whisper-\u8FDB\u884C\u8BED\u97F3\u8BC6\u522B",level:3},{value:"\u5B9E\u65F6\u8BED\u8A00\u8F6C\u6362",id:"\u5B9E\u65F6\u8BED\u8A00\u8F6C\u6362",level:2},{value:"\u5176\u4ED6\u5E38\u89C1\u95EE\u9898\u5904\u7406",id:"\u5176\u4ED6\u5E38\u89C1\u95EE\u9898\u5904\u7406",level:2},{value:"\u5728 WSL (Windows Subsystem for Linux) \u4E0A\u5B9E\u73B0\u97F3\u9891\u8F93\u5165\u548C\u8F93\u51FA",id:"\u5728-wsl-windows-subsystem-for-linux-\u4E0A\u5B9E\u73B0\u97F3\u9891\u8F93\u5165\u548C\u8F93\u51FA",level:3},{value:"\u5728 Windows \u4E0A\u4E0B\u8F7D\u5E76\u8BBE\u7F6E PulseAudio",id:"\u5728-windows-\u4E0A\u4E0B\u8F7D\u5E76\u8BBE\u7F6E-pulseaudio",level:3},{value:"\u914D\u7F6E WSL \u4EE5\u4F7F\u7528 PulseAudio",id:"\u914D\u7F6E-wsl-\u4EE5\u4F7F\u7528-pulseaudio",level:3},{value:"\u6D4B\u8BD5\u97F3\u9891\u529F\u80FD",id:"\u6D4B\u8BD5\u97F3\u9891\u529F\u80FD",level:3},{value:"\u53C2\u8003\u6587\u6863",id:"\u53C2\u8003\u6587\u6863",level:3}];function h(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"\u73AF\u5883\u51C6\u5907",children:"\u73AF\u5883\u51C6\u5907"}),"\n",(0,l.jsx)(n.p,{children:"Ubuntu 22.04 \u6216\u5176\u4ED6 Linux \u53D1\u884C\u7248\uFF0Cwindows \u4E0A\u8981\u914D\u7F6E\u7684\u4E1C\u897F\u6BD4\u8F83\u591A\uFF0C\u4E0D\u63A8\u8350\u3002"}),"\n",(0,l.jsx)(n.p,{children:"CUDA \u652F\u6301\u7684 Nvidia GPU (\u53EF\u9009)"}),"\n",(0,l.jsx)(n.h2,{id:"\u5B89\u88C5\u7F16\u8BD1\u5DE5\u5177",children:"\u5B89\u88C5\u7F16\u8BD1\u5DE5\u5177"}),"\n",(0,l.jsx)(n.p,{children:"\u5B89\u88C5\u7F16\u8BD1\u6240\u9700\u7684\u5DE5\u5177"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"sudo apt install build-essential\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u4E0B\u8F7D\u4E0E\u7F16\u8BD1-whispercpp",children:"\u4E0B\u8F7D\u4E0E\u7F16\u8BD1 Whisper.cpp"}),"\n",(0,l.jsxs)(n.p,{children:["\u4F7F\u7528 git \u514B\u9686 ",(0,l.jsx)(n.code,{children:"whisper.cpp"})," \u9879\u76EE"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"git clone https://github.com/ggerganov/whisper.cpp.git\ncd whisper.cpp\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u7F16\u8BD1\u9879\u76EE",children:"\u7F16\u8BD1\u9879\u76EE"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728\u9879\u76EE\u6839\u76EE\u5F55\u4E0B\u8FD0\u884C ",(0,l.jsx)(n.code,{children:"make"})," \u547D\u4EE4"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"make\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5982\u679C\u60A8\u6709 CUDA \u73AF\u5883\uFF0C\u53EF\u4EE5\u52A0\u901F\u7F16\u8BD1"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"make -j\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7F16\u8BD1\u540E\u4F1A\u51FA\u73B0 main \u53EF\u6267\u884C\u6587\u4EF6"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.img,{alt:"038653ba2e64f0a69d54057bc75f7ae3",src:s(78742).Z+"",width:"965",height:"1254"}),"## \u6A21\u578B\u4E0B\u8F7D"]}),"\n",(0,l.jsxs)(n.p,{children:["\u8FDB\u5165 ",(0,l.jsx)(n.code,{children:"models"})," \u76EE\u5F55\u5E76\u4E0B\u8F7D\u6240\u9700\u7684\u6A21\u578B"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"cd models\n./download-ggml-model.sh large-v3-turbo\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.img,{alt:"3f5577ff4ad66f88caa0eeb37895468d",src:s(55825).Z+"",width:"1202",height:"1029"}),"## \u97F3\u9891\u6587\u4EF6\u5904\u7406"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u51C6\u5907\u97F3\u9891\u6587\u4EF6"})}),"\n",(0,l.jsxs)(n.p,{children:["\u56E0\u4E3A ",(0,l.jsx)(n.code,{children:"whisper.cpp"})," \u9700\u8981 ",(0,l.jsx)(n.code,{children:".wav"})," \u683C\u5F0F\uFF0C\u786E\u4FDD\u97F3\u9891\u6587\u4EF6\u4E3A ",(0,l.jsx)(n.code,{children:".wav"})," \u683C\u5F0F\uFF0C\u53EF\u4EE5\u4F7F\u7528 ",(0,l.jsx)(n.code,{children:"ffmpeg"})," \u8FDB\u884C\u8F6C\u6362\uFF0C\u6CA1\u6709",(0,l.jsx)(n.code,{children:"ffmpeg"}),"\u9700\u8981\u63D0\u524D\u4E0B\u8F7D"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"apt install ffmpeg\nffmpeg -i /home/whisper.cpp/test_wma.wma -acodec pcm_s16le -ac 1 -ar 16000 /home/whisper.cpp/test_wav.wav\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u4F7F\u7528-whisper-\u8FDB\u884C\u8BED\u97F3\u8BC6\u522B",children:"\u4F7F\u7528 Whisper \u8FDB\u884C\u8BED\u97F3\u8BC6\u522B"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728\u9879\u76EE\u6839\u76EE\u5F55\u4E0B\u8FD0\u884C ",(0,l.jsx)(n.code,{children:"whisper"})," \u547D\u4EE4"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"./main -m ./models/ggml-large-v3-turbo.bin -f /home/whisper.cpp/test_wav.wav\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u5B9E\u65F6\u8BED\u8A00\u8F6C\u6362",children:"\u5B9E\u65F6\u8BED\u8A00\u8F6C\u6362"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"./stream -m ./models/ggml-large-v3-turbo.bin -f your_audio_device\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u5176\u4ED6\u5E38\u89C1\u95EE\u9898\u5904\u7406",children:"\u5176\u4ED6\u5E38\u89C1\u95EE\u9898\u5904\u7406"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"CUDA \u7F16\u8BD1\u95EE\u9898"})}),"\n",(0,l.jsxs)(n.p,{children:["\u5982\u679C\u9047\u5230 CUDA \u76F8\u5173\u7684\u7F16\u8BD1\u95EE\u9898\uFF0C\u786E\u4FDD\u5B89\u88C5\u4E86 ",(0,l.jsx)(n.code,{children:"nvidia-cuda-toolkit"})," \u548C\u5BF9\u5E94\u7684\u9A71\u52A8"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"sudo apt install nvidia-cuda-toolkit\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"ccache \u63D0\u5347\u7F16\u8BD1\u901F\u5EA6"})}),"\n",(0,l.jsxs)(n.p,{children:["\u5B89\u88C5 ",(0,l.jsx)(n.code,{children:"ccache"})," \u6765\u7F13\u5B58\u7F16\u8BD1\u7ED3\u679C"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"sudo apt install ccache\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u5728-wsl-windows-subsystem-for-linux-\u4E0A\u5B9E\u73B0\u97F3\u9891\u8F93\u5165\u548C\u8F93\u51FA",children:"\u5728 WSL (Windows Subsystem for Linux) \u4E0A\u5B9E\u73B0\u97F3\u9891\u8F93\u5165\u548C\u8F93\u51FA"}),"\n",(0,l.jsx)(n.h3,{id:"\u5728-windows-\u4E0A\u4E0B\u8F7D\u5E76\u8BBE\u7F6E-pulseaudio",children:"\u5728 Windows \u4E0A\u4E0B\u8F7D\u5E76\u8BBE\u7F6E PulseAudio"}),"\n",(0,l.jsxs)(n.p,{children:["\u4E0B\u8F7D PulseAudio for Windows \u5E76\u5C06\u5176\u89E3\u538B\u5230\u60A8\u7684\u7CFB\u7EDF\u4E0A\u7684\u67D0\u4E2A\u4F4D\u7F6E\uFF0C\u4F8B\u5982 ",(0,l.jsx)(n.code,{children:"C\\PulseAudio"}),"\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u7F16\u8F91 ",(0,l.jsx)(n.code,{children:"C\\PulseAudio\\etc\\pulse\\default.pa"})," \u6587\u4EF6\uFF0C\u786E\u4FDD\u6DFB\u52A0\u4EE5\u4E0B\u884C\u4EE5\u542F\u7528\u7F51\u7EDC\u97F3\u9891\u652F\u6301"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"load-module module-native-protocol-tcp auth-ip-acl=127.0.0.1 auth-anonymous=1\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u540C\u65F6\uFF0C\u60A8\u53EF\u80FD\u9700\u8981\u7F16\u8F91 ",(0,l.jsx)(n.code,{children:"C\\PulseAudio\\etc\\pulse\\daemon.conf"})," \u6587\u4EF6\uFF0C\u5E76\u8BBE\u7F6E"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"exit-idle-time = -1\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8FD0\u884C PulseAudio \u670D\u52A1"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"C\\PulseAudio\\bin\\pulseaudio.exe\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u914D\u7F6E-wsl-\u4EE5\u4F7F\u7528-pulseaudio",children:"\u914D\u7F6E WSL \u4EE5\u4F7F\u7528 PulseAudio"}),"\n",(0,l.jsx)(n.p,{children:"\u5728 WSL \u4E2D\u5B89\u88C5 PulseAudio \u5BA2\u6237\u7AEF\u5DE5\u5177\uFF08\u5982\u679C\u5C1A\u672A\u5B89\u88C5\uFF09"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"sudo apt update\nsudo apt install pulseaudio\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u914D\u7F6E WSL \u4F7F\u7528\u4ECE Windows \u4E3B\u673A\u8FD0\u884C\u7684 PulseAudio\uFF0C\u7F16\u8F91 ",(0,l.jsx)(n.code,{children:"~/.bashrc"})," \u6216\u76F8\u5E94\u7684 shell \u914D\u7F6E\u6587\u4EF6\uFF0C\u5E76\u6DFB\u52A0"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"export PULSE_SERVER=tcplocalhost\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u6D4B\u8BD5\u97F3\u9891\u529F\u80FD",children:"\u6D4B\u8BD5\u97F3\u9891\u529F\u80FD"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728 WSL \u4E2D\uFF0C\u60A8\u73B0\u5728\u5E94\u8BE5\u80FD\u591F\u901A\u8FC7 PulseAudio \u6765\u64AD\u653E\u97F3\u9891\u3002\u4F8B\u5982\uFF0C\u4F7F\u7528 ",(0,l.jsx)(n.code,{children:"aplay"})," \u6216\u5176\u4ED6\u97F3\u9891\u8F6F\u4EF6\u6D4B\u8BD5\u64AD\u653E\u58F0\u97F3\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"\u786E\u4FDD\u5728\u914D\u7F6E\u8FC7\u7A0B\u4E2D\uFF0CWindows \u9632\u706B\u5899\u5141\u8BB8 PulseAudio \u548C\u76F8\u5173\u7F51\u7EDC\u901A\u4FE1\u3002\u8FD9\u4E9B\u6B65\u9AA4\u6982\u8FF0\u4E86\u5728 WSL \u4E2D\u542F\u7528\u97F3\u9891\u7684\u57FA\u672C\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u9002\u7528\u4E8E\u5927\u591A\u6570\u9700\u8981\u97F3\u9891\u8F93\u5165\u8F93\u51FA\u7684\u573A\u666F"}),"\n",(0,l.jsx)(n.h3,{id:"\u53C2\u8003\u6587\u6863",children:"\u53C2\u8003\u6587\u6863"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://zhuanlan.zhihu.com/p/2765143936/https//www.freedesktop.org/wiki/Software/PulseAudio/Ports/Windows/Support/",children:"https://zhuanlan.zhihu.com/p/2765143936/https//www.freedesktop.org/wiki/Software/PulseAudio/Ports/Windows/Support/"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://zhuanlan.zhihu.com/p/2765143936/https//ktkr3d.github.io/2020/08/01/Enabling-sound-in-WSL/index.html",children:"https://zhuanlan.zhihu.com/p/2765143936/https//ktkr3d.github.io/2020/08/01/Enabling-sound-in-WSL/index.html"})}),"\n"]})]})}function p(e={}){let{wrapper:n}={...(0,d.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},78742:function(e,n,s){s.d(n,{Z:function(){return i}});let i=s.p+"assets/images/038653ba2e64f0a69d54057bc75f7ae3-5695bf9d1f2bb11a4997ebb7681c132b.jpg"},55825:function(e,n,s){s.d(n,{Z:function(){return i}});let i=s.p+"assets/images/3f5577ff4ad66f88caa0eeb37895468d-02bab36acaae5d9e3419694d9ee1a21b.jpg"},50065:function(e,n,s){s.d(n,{Z:function(){return r},a:function(){return c}});var i=s(67294);let l={},d=i.createContext(l);function c(e){let n=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),i.createElement(d.Provider,{value:n},e.children)}},30282:function(e){e.exports=JSON.parse('{"permalink":"/docs-hub/blog/whispercpp-\u5B89\u88C5\u4E0E\u4F7F\u7528\u6559\u7A0B","editUrl":"https://github.com/sumingcheng/docs-hub/blog/\u5F00\u53D1\u5DE5\u5177\u4E0E\u73AF\u5883/2024-10-27-Whispercpp_\u5B89\u88C5\u4E0E\u4F7F\u7528\u6559\u7A0B.md","source":"@site/blog/\u5F00\u53D1\u5DE5\u5177\u4E0E\u73AF\u5883/2024-10-27-Whispercpp_\u5B89\u88C5\u4E0E\u4F7F\u7528\u6559\u7A0B.md","title":"Whispercpp \u5B89\u88C5\u4E0E\u4F7F\u7528\u6559\u7A0B","description":"\u73AF\u5883\u51C6\u5907","date":"2024-10-27T00:00:00.000Z","tags":[{"inline":false,"label":"\u5F00\u53D1\u5DE5\u5177\u4E0E\u73AF\u5883","permalink":"/docs-hub/blog/tags/dev-tools","description":"\u5F00\u53D1\u5DE5\u5177\u548C\u73AF\u5883\u914D\u7F6E\u76F8\u5173\u6587\u7AE0"}],"readingTime":1.9766666666666666,"hasTruncateMarker":false,"authors":[{"name":"\u7D20\u660E\u8BDA","title":"Full stack development","url":"https://github.com/sumingcheng","page":{"permalink":"/docs-hub/blog/authors/sumingcheng"},"socials":{"x":"https://x.com/sumingcheng","github":"https://github.com/sumingcheng"},"imageURL":"https://github.com/user-attachments/assets/9a06bd55-094a-4efc-91c3-d1b92236822f","key":"sumingcheng"}],"frontMatter":{"slug":"whispercpp-\u5B89\u88C5\u4E0E\u4F7F\u7528\u6559\u7A0B","title":"Whispercpp \u5B89\u88C5\u4E0E\u4F7F\u7528\u6559\u7A0B","authors":["sumingcheng"],"tags":["dev-tools"],"date":"2024-10-27T00:00:00.000Z"},"unlisted":false,"prevItem":{"title":"Linux \u4E0D\u8F93\u5165\u5BC6\u7801\u83B7\u53D6 root \u6743\u9650","permalink":"/docs-hub/blog/linux-\u4E0D\u8F93\u5165\u5BC6\u7801\u83B7\u53D6-root-\u6743\u9650"},"nextItem":{"title":"Windows \u4E0A\u5B89\u88C5 CMake","permalink":"/docs-hub/blog/windows-\u4E0A\u5B89\u88C5-cmake"}}')}}]);