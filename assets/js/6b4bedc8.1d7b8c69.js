"use strict";(self.webpackChunknote_book=self.webpackChunknote_book||[]).push([[83727],{31584:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>r,default:()=>m,frontMatter:()=>d,metadata:()=>a,toc:()=>u});const a=JSON.parse('{"id":"Frontend/Vue/Vue\u6838\u5fc3\u7279\u6027/\u6df1\u5165\u7814\u7a76\u8ba1\u7b97\u5c5e\u6027\u4ee5\u53ca\u5e94\u7528\u573a\u666f\u5206\u6790","title":"\u8ba1\u7b97\u5c5e\u6027","description":"\u8ba1\u7b97\u5c5e\u6027\u7528\u4e8e\u89e3\u51b3\u6a21\u677f\u4e2d\u590d\u6742\u7684\u8ba1\u7b97\u4ee5\u53ca\u6570\u636e\u590d\u7528\u7684\u95ee\u9898\u3002\u5b83\u4ec5\u5728\u5176\u4f9d\u8d56\u7684\u6570\u636e\u53d1\u751f\u53d8\u5316\u65f6\u624d\u4f1a\u91cd\u65b0\u8ba1\u7b97\uff0c\u5e76\u4e14\u4f1a\u7f13\u5b58\u4e0a\u4e00\u6b21\u7684\u8ba1\u7b97\u7ed3\u679c\u3002\u5f53\u591a\u4e2a\u5730\u65b9\u9700\u8981\u590d\u7528\u76f8\u540c\u503c\u7684\u6570\u636e\u65f6\uff0c\u8ba1\u7b97\u5c5e\u6027\u53ea\u4f1a\u8c03\u7528\u4e00\u6b21\uff0c\u4ece\u800c\u63d0\u9ad8\u6027\u80fd\u548c\u6548\u7387\u3002","source":"@site/docs/Frontend/Vue/Vue\u6838\u5fc3\u7279\u6027/40.\u6df1\u5165\u7814\u7a76\u8ba1\u7b97\u5c5e\u6027\u4ee5\u53ca\u5e94\u7528\u573a\u666f\u5206\u6790.md","sourceDirName":"Frontend/Vue/Vue\u6838\u5fc3\u7279\u6027","slug":"/Frontend/Vue/Vue\u6838\u5fc3\u7279\u6027/\u6df1\u5165\u7814\u7a76\u8ba1\u7b97\u5c5e\u6027\u4ee5\u53ca\u5e94\u7528\u573a\u666f\u5206\u6790","permalink":"/docs-hub/docs/Frontend/Vue/Vue\u6838\u5fc3\u7279\u6027/\u6df1\u5165\u7814\u7a76\u8ba1\u7b97\u5c5e\u6027\u4ee5\u53ca\u5e94\u7528\u573a\u666f\u5206\u6790","draft":false,"unlisted":false,"editUrl":"https://github.com/sumingcheng/docs-hub/edit/main/docs/Frontend/Vue/Vue\u6838\u5fc3\u7279\u6027/40.\u6df1\u5165\u7814\u7a76\u8ba1\u7b97\u5c5e\u6027\u4ee5\u53ca\u5e94\u7528\u573a\u666f\u5206\u6790.md","tags":[],"version":"current","lastUpdatedBy":"sumingcheng","lastUpdatedAt":1733823976000,"sidebarPosition":40,"frontMatter":{},"sidebar":"vueSidebar","previous":{"title":"watch \u4e0e computed \u7684\u6df1\u5165\u6bd4\u8f83","permalink":"/docs-hub/docs/Frontend/Vue/Vue\u6838\u5fc3\u7279\u6027/computed\u4e0ewatch\u5e94\u7528\u5206\u6790"},"next":{"title":"Data","permalink":"/docs-hub/docs/Frontend/Vue/Vue\u6838\u5fc3\u7279\u6027/\u6df1\u5165\u7814\u7a76data\u5c5e\u6027\u4ee5\u53ca\u6570\u636e\u54cd\u5e94\u5f0f\u5b9e\u73b0"}}');var o=t(74848),c=t(28453);const d={},r="\u8ba1\u7b97\u5c5e\u6027",i={},u=[{value:"\u6a21\u677f\u4e2d\u5d4c\u5165\u65b9\u6cd5",id:"\u6a21\u677f\u4e2d\u5d4c\u5165\u65b9\u6cd5",level:2},{value:"\u5b9e\u73b0\u4f9d\u8d56\u6536\u96c6",id:"\u5b9e\u73b0\u4f9d\u8d56\u6536\u96c6",level:2}];function p(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"\u8ba1\u7b97\u5c5e\u6027",children:"\u8ba1\u7b97\u5c5e\u6027"})}),"\n",(0,o.jsx)(n.p,{children:"\u8ba1\u7b97\u5c5e\u6027\u7528\u4e8e\u89e3\u51b3\u6a21\u677f\u4e2d\u590d\u6742\u7684\u8ba1\u7b97\u4ee5\u53ca\u6570\u636e\u590d\u7528\u7684\u95ee\u9898\u3002\u5b83\u4ec5\u5728\u5176\u4f9d\u8d56\u7684\u6570\u636e\u53d1\u751f\u53d8\u5316\u65f6\u624d\u4f1a\u91cd\u65b0\u8ba1\u7b97\uff0c\u5e76\u4e14\u4f1a\u7f13\u5b58\u4e0a\u4e00\u6b21\u7684\u8ba1\u7b97\u7ed3\u679c\u3002\u5f53\u591a\u4e2a\u5730\u65b9\u9700\u8981\u590d\u7528\u76f8\u540c\u503c\u7684\u6570\u636e\u65f6\uff0c\u8ba1\u7b97\u5c5e\u6027\u53ea\u4f1a\u8c03\u7528\u4e00\u6b21\uff0c\u4ece\u800c\u63d0\u9ad8\u6027\u80fd\u548c\u6548\u7387\u3002"}),"\n",(0,o.jsx)(n.h2,{id:"\u6a21\u677f\u4e2d\u5d4c\u5165\u65b9\u6cd5",children:"\u6a21\u677f\u4e2d\u5d4c\u5165\u65b9\u6cd5"}),"\n",(0,o.jsx)(n.p,{children:"\u5728\u6a21\u677f\u4e2d\u5d4c\u5165\u65b9\u6cd5\u65f6\uff0c\u6bcf\u6b21\u8ba1\u7b97\u7684\u7ed3\u679c\u90fd\u4f1a\u5f62\u6210\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4ee5\u4fbf\u4fdd\u5b58\u548c\u7ba1\u7406\u6570\u636e\u3002\u8fd9\u79cd\u65b9\u5f0f\u6709\u52a9\u4e8e\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u91cd\u590d\u8ba1\u7b97\uff0c\u786e\u4fdd\u6570\u636e\u7684\u4e00\u81f4\u6027\u548c\u9ad8\u6548\u6027\u3002"}),"\n",(0,o.jsx)(n.h2,{id:"\u5b9e\u73b0\u4f9d\u8d56\u6536\u96c6",children:"\u5b9e\u73b0\u4f9d\u8d56\u6536\u96c6"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:"var Vue = (function () {\n  var templateVariableRegex = /\\{\\{(.+?)\\}\\}/g,\n    computedData = {},\n    dataPool = {};\n\n  /**\n   * computedData \u7ed3\u6784:\n   * {\n   *   total: {\n   *     value: \u51fd\u6570\u6267\u884c\u8fd4\u56de\u7684\u7ed3\u679c,\n   *     get: \u83b7\u53d6\u503c\u7684\u51fd\u6570,\n   *     dependencies: ['a', 'b']\n   *   }\n   * }\n   */\n\n  var Vue = function (options) {\n    this.$el = document.querySelector(options.el);\n    this.$data = options.data();\n\n    this._init(this, options.computed, options.template);\n  };\n\n  Vue.prototype._init = function (vm, computed, template) {\n    makeDataReactive(vm);\n    setupComputedProperties(vm, computed);\n    renderTemplate(vm, template);\n  };\n\n  function renderTemplate(vm, template) {\n    var container = document.createElement('div'),\n      rootElement = vm.$el;\n\n    container.innerHTML = template;\n\n    var compiledDom = compileTemplate(vm, container);\n\n    rootElement.appendChild(compiledDom);\n  }\n\n  function updateView(vm, key) {\n    dataPool[key].textContent = vm[key];\n  }\n\n  function compileTemplate(vm, container) {\n    var allNodes = container.getElementsByTagName('*'),\n      currentNode = null;\n\n    for (var i = 0; i < allNodes.length; i++) {\n      currentNode = allNodes[i];\n\n      var matches = currentNode.textContent.match(templateVariableRegex);\n\n      if (matches) {\n        currentNode.textContent = currentNode.textContent.replace(templateVariableRegex, function (node, key) {\n          dataPool[key.trim()] = currentNode;\n          return vm[key.trim()];\n        });\n      }\n    }\n\n    return container;\n  }\n\n  function makeDataReactive(vm) {\n    var data = vm.$data;\n\n    for (var key in data) {\n      (function (key) {\n        Object.defineProperty(vm, key, {\n          get() {\n            return data[key];\n          },\n          set(newValue) {\n            data[key] = newValue;\n            updateView(vm, key);\n            updateComputedProperties(vm, key, function (computedKey) {\n              updateView(vm, computedKey);\n            });\n          },\n        });\n      })(key);\n    }\n  }\n\n  function setupComputedProperties(vm, computed) {\n    initializeComputedData(vm, computed);\n\n    for (var key in computedData) {\n      (function (key) {\n        Object.defineProperty(vm, key, {\n          get() {\n            return computedData[key].value;\n          },\n          set(newValue) {\n            computedData[key].value = newValue;\n          },\n        });\n      })(key);\n    }\n  }\n\n  function initializeComputedData(vm, computed) {\n    for (var key in computed) {\n      var descriptor = Object.getOwnPropertyDescriptor(computed, key),\n        computeFn = descriptor.value.get ? descriptor.value.get : descriptor.value;\n\n      /**\n       * computedData \u7ed3\u6784:\n       * {\n       *   total: {\n       *     value: \u51fd\u6570\u6267\u884c\u8fd4\u56de\u7684\u7ed3\u679c,\n       *     get: \u83b7\u53d6\u503c\u7684\u51fd\u6570,\n       *     dependencies: ['a', 'b']\n       *   }\n       * }\n       */\n\n      computedData[key] = {};\n      computedData[key].value = computeFn.call(vm);\n      computedData[key].get = computeFn.bind(vm);\n      computedData[key].dependencies = collectDependencies(computeFn);\n    }\n  }\n\n  function collectDependencies(fn) {\n    var dependencies = fn.toString().match(/this\\.(\\w+)/g);\n\n    if (dependencies) {\n      dependencies = dependencies.map((dep) => dep.split('.')[1]);\n    } else {\n      dependencies = [];\n    }\n\n    return dependencies;\n  }\n\n  function updateComputedProperties(vm, changedKey, callback) {\n    for (var key in computedData) {\n      var deps = computedData[key].dependencies;\n\n      if (deps.includes(changedKey)) {\n        vm[key] = computedData[key].get();\n        callback(key);\n      }\n    }\n  }\n\n  return Vue;\n})();\n\nexport default Vue;\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u8ba1\u7b97\u5c5e\u6027\u7684\u5b9e\u73b0\u6d89\u53ca\u5230\u4f9d\u8d56\u6536\u96c6\u548c\u6570\u636e\u54cd\u5e94\u5f0f\u5904\u7406\u3002\u901a\u8fc7\u6b63\u5219\u8868\u8fbe\u5f0f\u8bc6\u522b\u6a21\u677f\u4e2d\u7684\u53d8\u91cf\uff0c\u5e76\u5728\u6570\u636e\u53d8\u5316\u65f6\u81ea\u52a8\u66f4\u65b0\u76f8\u5173\u7684\u89c6\u56fe\u3002\u6b64\u5916\uff0c\u8ba1\u7b97\u5c5e\u6027\u901a\u8fc7\u7f13\u5b58\u673a\u5236\u907f\u514d\u4e86\u4e0d\u5fc5\u8981\u7684\u91cd\u590d\u8ba1\u7b97\uff0c\u63d0\u9ad8\u4e86\u5e94\u7528\u7684\u6027\u80fd\u3002\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u5408\u7406\u4f7f\u7528\u8ba1\u7b97\u5c5e\u6027\u80fd\u591f\u663e\u8457\u7b80\u5316\u6a21\u677f\u903b\u8f91\uff0c\u63d0\u5347\u4ee3\u7801\u7684\u53ef\u7ef4\u62a4\u6027\u548c\u6548\u7387\u3002"})]})}function m(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>r});var a=t(96540);const o={},c=a.createContext(o);function d(e){const n=a.useContext(c);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),a.createElement(c.Provider,{value:n},e.children)}}}]);