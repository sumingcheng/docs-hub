"use strict";(self.webpackChunknote_book=self.webpackChunknote_book||[]).push([[98380],{95516:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"Frontend/Vue/Vue\u8fdb\u9636\u7279\u6027/\u6570\u636e\u52ab\u6301\u6e90\u7801","title":"\u5b9e\u73b0 Vue2.0 \u6570\u636e\u52ab\u6301","description":"vue.js","source":"@site/docs/Frontend/Vue/Vue\u8fdb\u9636\u7279\u6027/40.\u6570\u636e\u52ab\u6301\u6e90\u7801.md","sourceDirName":"Frontend/Vue/Vue\u8fdb\u9636\u7279\u6027","slug":"/Frontend/Vue/Vue\u8fdb\u9636\u7279\u6027/\u6570\u636e\u52ab\u6301\u6e90\u7801","permalink":"/docs-hub/docs/Frontend/Vue/Vue\u8fdb\u9636\u7279\u6027/\u6570\u636e\u52ab\u6301\u6e90\u7801","draft":false,"unlisted":false,"editUrl":"https://github.com/sumingcheng/docs-hub/edit/main/docs/Frontend/Vue/Vue\u8fdb\u9636\u7279\u6027/40.\u6570\u636e\u52ab\u6301\u6e90\u7801.md","tags":[],"version":"current","lastUpdatedBy":"sumingcheng","lastUpdatedAt":1733823976000,"sidebarPosition":40,"frontMatter":{},"sidebar":"vueSidebar","previous":{"title":"\u5e94\u7528\u5b9e\u4f8b","permalink":"/docs-hub/docs/Frontend/Vue/Vue\u8fdb\u9636\u7279\u6027/\u5e94\u7528\u5b9e\u4f8b-\u7ec4\u4ef6\u5b9e\u4f8b\u4e0e\u6839\u7ec4\u4ef6\u5b9e\u4f8b"},"next":{"title":"\u89c2\u5bdf\u8005\u6a21\u5f0f","permalink":"/docs-hub/docs/Frontend/Vue/Vue\u8fdb\u9636\u7279\u6027/\u89c2\u5bdf\u8005\u548c\u53d1\u5e03\u8ba2\u9605"}}');var r=a(74848),s=a(28453);const o={},i="\u5b9e\u73b0 Vue2.0 \u6570\u636e\u52ab\u6301",d={},c=[{value:"vue.js",id:"vuejs",level:2},{value:"initState.js",id:"initstatejs",level:2},{value:"proxyData.js",id:"proxydatajs",level:2},{value:"observe.js",id:"observejs",level:2},{value:"observer.js",id:"observerjs",level:2},{value:"reactive.js",id:"reactivejs",level:2},{value:"array.js",id:"arrayjs",level:2},{value:"config.js",id:"configjs",level:2},{value:"observeArr.js",id:"observearrjs",level:2}];function l(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"\u5b9e\u73b0-vue20-\u6570\u636e\u52ab\u6301",children:"\u5b9e\u73b0 Vue2.0 \u6570\u636e\u52ab\u6301"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"import Vue from './vue.js';\n\nconst vm = new Vue({\n  el: '#app',\n  data() {\n    return {\n      a: 1,\n      b: 2,\n      studentList: [3, 4, 5, 6, 7],\n      info: {\n        a: {\n          b: 1,\n        },\n      },\n      obj: [\n        {\n          id: 8,\n          name: 'Tom',\n          age: 28,\n        },\n        {\n          id: 9,\n          name: 'Jack',\n          age: 29,\n        },\n        {\n          id: 10,\n          name: 'Jack',\n          age: 30,\n        },\n      ],\n    };\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"vuejs",children:"vue.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"import { initState } from './initState.js';\n\n/**\n * Vue\u6784\u9020\u51fd\u6570\n * @param {*} options \u914d\u7f6e\u9879\n */\nfunction Vue(options) {\n  // \u5224\u65ad\u5f53\u524d\u914d\u7f6e\u9879\u7684\u7c7b\u578b\uff0c\u5982\u679c\u7c7b\u578b\u4e0d\u5339\u914d\u5219\u8fd4\u56de\n  if (typeof options !== 'object' || options === null) return;\n  // Vue\u521d\u59cb\u5316\u51fd\u6570\n  this._init(options);\n}\n\nVue.prototype._init = function (options) {\n  // \u5b9e\u4f8b\u5316\u5bf9\u8c61\n  const vm = this;\n  // options\u914d\u7f6e\u9879\u6302\u8f7d\u5230\u5b9e\u4f8b\u5bf9\u8c61\u4e2d\n  this.$options = options;\n  // \u521d\u59cb\u5316\u5b9e\u4f8b\u5bf9\u8c61\u7684\u72b6\u6001\n  initState(vm);\n};\n\nexport default Vue;\n"})}),"\n",(0,r.jsx)(e.h2,{id:"initstatejs",children:"initState.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"// \u6570\u636e\u52ab\u6301\u7ed1\u5b9a\nimport proxyData from './proxyData.js';\n// \u6570\u636e\u89c2\u5bdf\nimport observe from './observe.js';\n\nfunction initState(vm) {\n  // \u83b7\u53d6\u5b9e\u4f8b\u5bf9\u8c61\u4e0a\u7684$options\u5c5e\u6027\n  const option = vm.$options;\n  // \u5224\u65ad$options\u5c5e\u6027\u4e2d\u662f\u5426\u5b58\u5728data\u5c5e\u6027\n  if (option.data) {\n    // \u5982\u679c\u5b58\u5728data\u5c5e\u6027\uff0c\u6267\u884c\u521d\u59cb\u5316data\u65b9\u6cd5\n    initData(vm);\n  }\n}\n\nfunction initData(vm) {\n  // \u83b7\u53d6\u5b9e\u4f8b\u5bf9\u8c61\u7684data\u5c5e\u6027\n  let data = vm.$options.data;\n  // \u5728\u5b9e\u4f8b\u5bf9\u8c61\u6302\u8f7d_data\u5c5e\u6027\uff0c\u662fdata\u5c5e\u6027\u6267\u884c\u540e\u7684\u8fd4\u56de\u503c;\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data || {};\n  // \u901a\u8fc7\u6570\u636e\u52ab\u6301\u7684\u65b9\u5f0f\u5904\u7406vm.a\u3001vm.b\u53ef\u4ee5\u76f4\u63a5\u83b7\u53d6\u503c\u7684\u9700\u6c42;\n  for (const key in data) {\n    // \u8bbe\u7f6e\u4ee3\u7406\u6570\u636e\u7684\u65b9\u6cd5\n    proxyData(vm, '_data', key);\n  }\n  // \u8fdb\u884c\u5b8c\u6570\u636e\u7ed1\u5b9a\u540e\uff0c\u9700\u8981\u89c2\u5bdfdata\u6570\u636e\u7684\u66f4\u65b0\n  observe(data);\n}\n\nexport { initState };\n"})}),"\n",(0,r.jsx)(e.h2,{id:"proxydatajs",children:"proxyData.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"/**\n * @param {*} vm \u5b9e\u4f8b\u5316\u5bf9\u8c61\n * @param {*} target \u76ee\u6807\u5bf9\u8c61\u5c5e\u6027\n * @param {*} key \u5bf9\u8c61\u952e\u540d\n */\nfunction proxyData(vm, target, key) {\n  // \u6570\u636e\u52ab\u6301\u7ed1\u5b9a\n  Object.defineProperty(vm, key, {\n    get() {\n      // vm.a ---\x3e vm['_data']['a'];\n      return vm[target][key];\n    },\n    set(newValue) {\n      // vm.a = 3 --\x3e vm['_data']['a'] = 3;\n      if (newValue === vm[target][key]) return;\n      vm[target][key] = newValue;\n    },\n  });\n}\n\nexport default proxyData;\n"})}),"\n",(0,r.jsx)(e.h2,{id:"observejs",children:"observe.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"// \u5f15\u5165\u89c2\u5bdf\u8005\nimport Observer from './observer.js';\n\n/**\n * @param {*} data vm._data\u5c5e\u6027\n */\nfunction observe(data) {\n  // \u5224\u65advm.data\u5c5e\u6027\u7c7b\u578b\n  if (typeof data !== 'object' || data === null) return;\n  // \u8bbe\u7f6e\u89c2\u5bdf\u8005\u5b9e\u4f8b\u5bf9\u8c61\n  return new Observer(data);\n}\n\nexport default observe;\n"})}),"\n",(0,r.jsx)(e.h2,{id:"observerjs",children:"observer.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"// \u5f15\u5165\u6570\u636e\u54cd\u5e94\u5f0f\u7684\u65b9\u6cd5\nimport { defineReactiveData } from './reactive.js';\n// \u5f15\u5165\u6570\u7ec4\u5904\u7406\u65b9\u6cd5\nimport { arrMethods } from './array';\nimport observeArr from './observeArr';\n\n/**\n * @param {*} data vm._data\n */\nfunction Observer(data) {\n  // \u5224\u65advm._data\u5c5e\u6027\u7c7b\u578b\u662f\u6570\u7ec4\u8fd8\u662f\u5bf9\u8c61;\n  if (Array.isArray(data)) {\n    data.__proto__ = arrMethods;\n    observeArr(data);\n  } else {\n    // \u662f\u5bf9\u8c61\uff0c\u6267\u884cwalk\u65b9\u6cd5;\n    this.walk(data);\n  }\n}\n\nObserver.prototype.walk = function (data) {\n  // \u83b7\u53d6vm._data\u5bf9\u8c61\u7684\u53ef\u679a\u4e3e\u952e\u540d keys --\x3e ['a', 'b', 'students', 'obj']\n  const keys = Object.keys(data);\n  // \u5faa\u73af\u904d\u5386keys\u6570\u7ec4\n  for (let i = 0; i < keys.length; i++) {\n    // \u83b7\u53d6vm._data\u5bf9\u8c61\u7684\u952e\u540d\u548c\u952e\u503c;\n    const key = keys[i];\n    const value = data[key];\n    // \u6267\u884c\u6570\u636e\u54cd\u5e94\u5f0f\u7684\u65b9\u6cd5\n    defineReactiveData(data, key, value);\n  }\n};\n\nexport default Observer;\n"})}),"\n",(0,r.jsx)(e.h2,{id:"reactivejs",children:"reactive.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"function defineReactiveData(data, key, value) {\n  // \u5b58\u5728\u7684\u95ee\u9898\uff1a\u6b64\u65f6value\u53ef\u80fd\u8fd8\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u6216\u8005\u662f\u6570\u7ec4\n  // \u9012\u5f52\u89c2\u5bdf\n  observe(value);\n\n  // \u6570\u636e\u52ab\u6301\n  Object.defineProperty(data, key, {\n    get() {\n      console.log('\u54cd\u5e94\u5f0f\u6570\u636e: \u83b7\u53d6', value);\n      return value;\n    },\n    set(newValue) {\n      console.log('\u54cd\u5e94\u5f0f\u8bbe\u7f6e: \u8bbe\u7f6e', newValue);\n      if (newValue === value) return;\n      // \u9012\u5f52\u89c2\u5bdf\n      observe(newValue);\n      value = newValue;\n    },\n  });\n}\n\nexport { defineReactiveData };\n"})}),"\n",(0,r.jsx)(e.h2,{id:"arrayjs",children:"array.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"// \u5f15\u5165\u66f4\u6539\u539f\u6570\u7ec4\u65b9\u6cd5\u7684\u914d\u7f6e\u5bf9\u8c61\nimport { ARR_METHODS } from './config';\n// \u5f15\u5165\u89c2\u5bdf\u6570\u7ec4\u7684\u65b9\u6cd5\nimport observeArr from './observeArr.js';\n\nconst originArrMethods = Array.prototype;\nconst arrMethods = Object.create(originArrMethods);\n\nARR_METHODS.forEach(function (m) {\n  // \u539f\u6570\u7ec4\u7684\u57fa\u7840\u4e0a\u5305\u88f9\u4e00\u5c42\u51fd\u6570\uff0c\u76ee\u7684\u662f\u6267\u884c\u539f\u6709\u51fd\u6570\u540e\u8fd8\u80fd\u591f\u6267\u884c\u5176\u4ed6\u903b\u8f91;\n  arrMethods[m] = function () {\n    const args = Array.prototype.slice.call(arguments);\n    // \u6267\u884c\u539f\u6709\u7684\u6570\u7ec4\u65b9\u6cd5\n    const rt = originArrMethods[m].apply(this, args);\n\n    // \u6267\u884c\u5176\u4ed6\u903b\u8f91\n    let newArr;\n    switch (m) {\n      case 'push':\n      case 'unshift':\n        newArr = args;\n        break;\n      case 'splice':\n        newArr = args.slice(2);\n        break;\n      default:\n        break;\n    }\n    newArr && observeArr(newArr);\n    return rt;\n  };\n});\n\nexport { arrMethods };\n"})}),"\n",(0,r.jsx)(e.h2,{id:"configjs",children:"config.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"const ARR_METHODS = ['push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse'];\n"})}),"\n",(0,r.jsx)(e.h2,{id:"observearrjs",children:"observeArr.js"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"// \u5f15\u5165observe\u89c2\u5bdf\u7684\u65b9\u6cd5\nimport observe from './observe';\n\nfunction observeArr(arr) {\n  for (let i = 0; i < arr.length; i++) {\n    observe(arr[i]);\n  }\n}\n\nexport default observeArr;\n"})})]})}function u(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(l,{...n})}):l(n)}},28453:(n,e,a)=>{a.d(e,{R:()=>o,x:()=>i});var t=a(96540);const r={},s=t.createContext(r);function o(n){const e=t.useContext(s);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:o(n.components),t.createElement(s.Provider,{value:e},n.children)}}}]);