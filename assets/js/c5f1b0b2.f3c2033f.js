"use strict";(self.webpackChunknote_book=self.webpackChunknote_book||[]).push([[33594],{60661:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"Backend/MongoDB/MongoDB\u5b89\u5168\u4e0e\u6743\u9650","title":"MongoDB \u5b89\u5168\u4e0e\u6743\u9650\u7ba1\u7406","description":"\u7528\u6237\u8ba4\u8bc1","source":"@site/docs/Backend/MongoDB/040-MongoDB\u5b89\u5168\u4e0e\u6743\u9650.md","sourceDirName":"Backend/MongoDB","slug":"/Backend/MongoDB/MongoDB\u5b89\u5168\u4e0e\u6743\u9650","permalink":"/docs-hub/Backend/MongoDB/MongoDB\u5b89\u5168\u4e0e\u6743\u9650","draft":false,"unlisted":false,"editUrl":"https://github.com/sumingcheng/docs-hub/edit/main/docs/Backend/MongoDB/040-MongoDB\u5b89\u5168\u4e0e\u6743\u9650.md","tags":[],"version":"current","lastUpdatedBy":"sumingcheng","lastUpdatedAt":1733919630000,"sidebarPosition":40,"frontMatter":{},"sidebar":"mongodbSidebar","previous":{"title":"MongoDB \u805a\u5408\u64cd\u4f5c\u4e0e\u6570\u636e\u5efa\u6a21","permalink":"/docs-hub/Backend/MongoDB/MongoDB\u805a\u5408\u4e0e\u5efa\u6a21"}}');var d=s(74848),r=s(28453);const a={},i="MongoDB \u5b89\u5168\u4e0e\u6743\u9650\u7ba1\u7406",o={},c=[{value:"\u7528\u6237\u8ba4\u8bc1",id:"\u7528\u6237\u8ba4\u8bc1",level:2},{value:"\u521b\u5efa\u7ba1\u7406\u5458\u7528\u6237",id:"\u521b\u5efa\u7ba1\u7406\u5458\u7528\u6237",level:3},{value:"\u542f\u7528\u8ba4\u8bc1",id:"\u542f\u7528\u8ba4\u8bc1",level:3},{value:"\u89d2\u8272\u7ba1\u7406",id:"\u89d2\u8272\u7ba1\u7406",level:2},{value:"\u5185\u7f6e\u89d2\u8272",id:"\u5185\u7f6e\u89d2\u8272",level:3},{value:"\u81ea\u5b9a\u4e49\u89d2\u8272",id:"\u81ea\u5b9a\u4e49\u89d2\u8272",level:3},{value:"\u7f51\u7edc\u5b89\u5168",id:"\u7f51\u7edc\u5b89\u5168",level:2},{value:"SSL/TLS \u914d\u7f6e",id:"ssltls-\u914d\u7f6e",level:3},{value:"\u9632\u706b\u5899\u8bbe\u7f6e",id:"\u9632\u706b\u5899\u8bbe\u7f6e",level:3},{value:"\u5ba1\u8ba1\u673a\u5236",id:"\u5ba1\u8ba1\u673a\u5236",level:2},{value:"\u5f00\u542f\u5ba1\u8ba1",id:"\u5f00\u542f\u5ba1\u8ba1",level:3},{value:"\u5ba1\u8ba1\u4e8b\u4ef6\u8fc7\u6ee4",id:"\u5ba1\u8ba1\u4e8b\u4ef6\u8fc7\u6ee4",level:3},{value:"\u6570\u636e\u52a0\u5bc6",id:"\u6570\u636e\u52a0\u5bc6",level:2},{value:"\u9759\u6001\u52a0\u5bc6",id:"\u9759\u6001\u52a0\u5bc6",level:3},{value:"\u5b57\u6bb5\u7ea7\u52a0\u5bc6",id:"\u5b57\u6bb5\u7ea7\u52a0\u5bc6",level:3}];function t(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"mongodb-\u5b89\u5168\u4e0e\u6743\u9650\u7ba1\u7406",children:"MongoDB \u5b89\u5168\u4e0e\u6743\u9650\u7ba1\u7406"})}),"\n",(0,d.jsx)(n.h2,{id:"\u7528\u6237\u8ba4\u8bc1",children:"\u7528\u6237\u8ba4\u8bc1"}),"\n",(0,d.jsx)(n.h3,{id:"\u521b\u5efa\u7ba1\u7406\u5458\u7528\u6237",children:"\u521b\u5efa\u7ba1\u7406\u5458\u7528\u6237"}),"\n",(0,d.jsx)(n.p,{children:"\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u7b14\u8005\u9996\u5148\u521b\u5efa\u4e86\u7ba1\u7406\u5458\u7528\u6237\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-javascript",children:'use admin\ndb.createUser({\n  user: "adminUser",\n  pwd: "securePassword123",\n  roles: [\n    { role: "userAdminAnyDatabase", db: "admin" },\n    { role: "readWriteAnyDatabase", db: "admin" }\n  ]\n})\n'})}),"\n",(0,d.jsx)(n.h3,{id:"\u542f\u7528\u8ba4\u8bc1",children:"\u542f\u7528\u8ba4\u8bc1"}),"\n",(0,d.jsx)(n.p,{children:"\u7b14\u8005\u4fee\u6539\u4e86 MongoDB \u7684\u914d\u7f6e\u6587\u4ef6\u4ee5\u5f00\u542f\u8ba4\u8bc1\u673a\u5236\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"security:\n  authorization: enabled\n  clusterAuthMode: x509\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u89d2\u8272\u7ba1\u7406",children:"\u89d2\u8272\u7ba1\u7406"}),"\n",(0,d.jsx)(n.h3,{id:"\u5185\u7f6e\u89d2\u8272",children:"\u5185\u7f6e\u89d2\u8272"}),"\n",(0,d.jsx)(n.p,{children:"MongoDB \u63d0\u4f9b\u4e86\u591a\u79cd\u5185\u7f6e\u89d2\u8272\u4ee5\u6ee1\u8db3\u4e0d\u540c\u7684\u9700\u6c42\u3002\u7b14\u8005\u521b\u5efa\u4e86\u6570\u636e\u5e93\u7ba1\u7406\u5458\u548c\u53ea\u8bfb\u7528\u6237\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-javascript",children:"// \u6570\u636e\u5e93\u7ba1\u7406\u5458\ndb.createUser({\n  user: 'dbAdmin',\n  pwd: 'dbPass123',\n  roles: [{ role: 'dbAdmin', db: 'businessDB' }],\n});\n\n// \u53ea\u8bfb\u7528\u6237\ndb.createUser({\n  user: 'readOnlyUser',\n  pwd: 'readPass123',\n  roles: [{ role: 'read', db: 'businessDB' }],\n});\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49\u89d2\u8272",children:"\u81ea\u5b9a\u4e49\u89d2\u8272"}),"\n",(0,d.jsx)(n.p,{children:"\u4e3a\u4e86\u6ee1\u8db3\u7279\u5b9a\u6743\u9650\u9700\u6c42\uff0c\u7b14\u8005\u521b\u5efa\u4e86\u81ea\u5b9a\u4e49\u89d2\u8272\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-javascript",children:"db.createRole({\n  role: 'orderProcessor',\n  privileges: [\n    {\n      resource: { db: 'businessDB', collection: 'orders' },\n      actions: ['find', 'update'],\n    },\n  ],\n  roles: [],\n});\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u7f51\u7edc\u5b89\u5168",children:"\u7f51\u7edc\u5b89\u5168"}),"\n",(0,d.jsx)(n.h3,{id:"ssltls-\u914d\u7f6e",children:"SSL/TLS \u914d\u7f6e"}),"\n",(0,d.jsx)(n.p,{children:"\u7b14\u8005\u914d\u7f6e\u4e86 SSL/TLS \u4ee5\u52a0\u5bc6\u4f20\u8f93\u6570\u636e\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"net:\n  ssl:\n    mode: requireSSL\n    PEMKeyFile: /path/to/mongodb.pem\n    CAFile: /path/to/ca.pem\n    allowInvalidCertificates: false\n    allowInvalidHostnames: false\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u9632\u706b\u5899\u8bbe\u7f6e",children:"\u9632\u706b\u5899\u8bbe\u7f6e"}),"\n",(0,d.jsx)(n.p,{children:"\u4e3a\u4e86\u9650\u5236 MongoDB \u7684\u8bbf\u95ee\uff0c\u7b14\u8005\u8bbe\u7f6e\u4e86\u9632\u706b\u5899\uff0c\u4ec5\u5141\u8bb8\u7279\u5b9a IP \u8bbf\u95ee\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"net:\n  bindIp: 127.0.0.1,192.168.1.100\n  port: 27017\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u5ba1\u8ba1\u673a\u5236",children:"\u5ba1\u8ba1\u673a\u5236"}),"\n",(0,d.jsx)(n.h3,{id:"\u5f00\u542f\u5ba1\u8ba1",children:"\u5f00\u542f\u5ba1\u8ba1"}),"\n",(0,d.jsx)(n.p,{children:"\u7b14\u8005\u914d\u7f6e\u4e86\u5ba1\u8ba1\u65e5\u5fd7\u4ee5\u8bb0\u5f55\u5173\u952e\u64cd\u4f5c\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"security:\n  authorization: enabled\n  audit:\n    destination: file\n    format: JSON\n    path: /var/log/mongodb/audit.json\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u5ba1\u8ba1\u4e8b\u4ef6\u8fc7\u6ee4",children:"\u5ba1\u8ba1\u4e8b\u4ef6\u8fc7\u6ee4"}),"\n",(0,d.jsx)(n.p,{children:"\u8bbe\u7f6e\u9700\u8981\u5ba1\u8ba1\u7684\u64cd\u4f5c\u7c7b\u578b\uff0c\u7b14\u8005\u9009\u62e9\u4e86\u8ba4\u8bc1\u3001\u521b\u5efa\u96c6\u5408\u548c\u5220\u9664\u96c6\u5408\u4e8b\u4ef6\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-javascript",children:"db.setAuditConfig({\n  auditFilter: {\n    atype: {\n      $in: ['authenticate', 'createCollection', 'dropCollection'],\n    },\n  },\n});\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u6570\u636e\u52a0\u5bc6",children:"\u6570\u636e\u52a0\u5bc6"}),"\n",(0,d.jsx)(n.h3,{id:"\u9759\u6001\u52a0\u5bc6",children:"\u9759\u6001\u52a0\u5bc6"}),"\n",(0,d.jsx)(n.p,{children:"\u7b14\u8005\u914d\u7f6e\u4e86\u5b58\u50a8\u52a0\u5bc6\u4ee5\u4fdd\u62a4\u9759\u6001\u6570\u636e\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"security:\n  enableEncryption: true\n  encryptionKeyFile: /path/to/key.file\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u5b57\u6bb5\u7ea7\u52a0\u5bc6",children:"\u5b57\u6bb5\u7ea7\u52a0\u5bc6"}),"\n",(0,d.jsx)(n.p,{children:"\u5bf9\u4e8e\u654f\u611f\u5b57\u6bb5\uff0c\u7b14\u8005\u5b9e\u65bd\u4e86\u5b57\u6bb5\u7ea7\u52a0\u5bc6\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-javascript",children:"db.createCollection('users', {\n  validator: {\n    $jsonSchema: {\n      properties: {\n        ssn: {\n          encrypt: {\n            keyId: [UUID('key1')],\n            algorithm: 'AEAD_AES_256_CBC_HMAC_SHA_512_Random',\n          },\n        },\n      },\n    },\n  },\n});\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(t,{...e})}):t(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>i});var l=s(96540);const d={},r=l.createContext(d);function a(e){const n=l.useContext(r);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:a(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);