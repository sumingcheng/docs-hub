"use strict";(self.webpackChunknote_book=self.webpackChunknote_book||[]).push([[24214],{20115:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>i,default:()=>t,frontMatter:()=>r,metadata:()=>l,toc:()=>a});const l=JSON.parse('{"id":"Frontend/JavaScript/Promise/Promise-\u9898\u96c6","title":"\u5f02\u6b65\u7f16\u7a0b\u8be6\u89e3","description":"\u540c\u6b65\u4efb\u52a1\u3001\u5fae\u4efb\u52a1\u3001\u5f02\u6b65\u4efb\u52a1","source":"@site/docs/Frontend/JavaScript/Promise/40.Promise-\u9898\u96c6.md","sourceDirName":"Frontend/JavaScript/Promise","slug":"/Frontend/JavaScript/Promise/Promise-\u9898\u96c6","permalink":"/docs-hub/docs/Frontend/JavaScript/Promise/Promise-\u9898\u96c6","draft":false,"unlisted":false,"editUrl":"https://github.com/sumingcheng/docs-hub/edit/main/docs/Frontend/JavaScript/Promise/40.Promise-\u9898\u96c6.md","tags":[],"version":"current","lastUpdatedBy":"sumingcheng","lastUpdatedAt":1733823104000,"sidebarPosition":40,"frontMatter":{},"sidebar":"javascriptSidebar","previous":{"title":"\u4f7f\u7528 promises-aplus-tests \u8fdb\u884c Promise \u5b9e\u73b0\u6d4b\u8bd5","permalink":"/docs-hub/docs/Frontend/JavaScript/Promise/\u5b9e\u73b0Promise\u5468\u8fb9\u65b9\u6cd5"},"next":{"title":"Promise \u7ec3\u4e60\u9898","permalink":"/docs-hub/docs/Frontend/JavaScript/Promise/Promise-\u7ec3\u4e60\u9898"}}');var c=s(74848),o=s(28453);const r={},i="\u5f02\u6b65\u7f16\u7a0b\u8be6\u89e3",d={},a=[{value:"\u540c\u6b65\u4efb\u52a1\u3001\u5fae\u4efb\u52a1\u3001\u5f02\u6b65\u4efb\u52a1",id:"\u540c\u6b65\u4efb\u52a1\u5fae\u4efb\u52a1\u5f02\u6b65\u4efb\u52a1",level:2},{value:"\u5fae\u4efb\u52a1",id:"\u5fae\u4efb\u52a1",level:2},{value:"Promise.all",id:"promiseall",level:2},{value:"Promise.race",id:"promiserace",level:2},{value:"async",id:"async",level:2},{value:"await",id:"await",level:2},{value:"\u5f02\u6b65\u4efb\u52a1",id:"\u5f02\u6b65\u4efb\u52a1",level:2},{value:"pending",id:"pending",level:2},{value:"await \u4e0e\u5fae\u4efb\u52a1",id:"await-\u4e0e\u5fae\u4efb\u52a1",level:2},{value:"\u5fae\u4efb\u52a1\u6267\u884c",id:"\u5fae\u4efb\u52a1\u6267\u884c",level:2},{value:"\u591a\u4e2a\u5fae\u4efb\u52a1",id:"\u591a\u4e2a\u5fae\u4efb\u52a1",level:2},{value:"reject",id:"reject",level:2},{value:"try...catch",id:"trycatch",level:2},{value:"\u7efc\u5408\u793a\u4f8b",id:"\u7efc\u5408\u793a\u4f8b",level:2},{value:"finally",id:"finally",level:2}];function h(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.header,{children:(0,c.jsx)(e.h1,{id:"\u5f02\u6b65\u7f16\u7a0b\u8be6\u89e3",children:"\u5f02\u6b65\u7f16\u7a0b\u8be6\u89e3"})}),"\n",(0,c.jsx)(e.h2,{id:"\u540c\u6b65\u4efb\u52a1\u5fae\u4efb\u52a1\u5f02\u6b65\u4efb\u52a1",children:"\u540c\u6b65\u4efb\u52a1\u3001\u5fae\u4efb\u52a1\u3001\u5f02\u6b65\u4efb\u52a1"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"const first = () =>\n  new Promise((resolve, reject) => {\n    console.log(3); // \u540c\u6b651 3\n    let p = new Promise((resolve, reject) => {\n      console.log(7); // \u540c\u6b652 7\n      setTimeout(() => {\n        console.log(5); // \u5f02\u6b651 5\n        resolve(6);\n        console.log(p); // \u5f02\u6b652 fulfilled 1\n      }, 0);\n      resolve(1);\n    });\n    resolve(2);\n    p.then((arg) => {\n      console.log(arg); // \u5fae\u4efb\u52a11 1\n    });\n  });\n\nfirst().then((arg) => {\n  console.log(arg); // \u5fae\u4efb\u52a12 2\n});\n\nconsole.log(4); // \u540c\u6b653 4\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u5728\u8fd9\u6bb5\u4ee3\u7801\u4e2d\uff0c\u6267\u884c\u987a\u5e8f\u5982\u4e0b\uff1a"}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"console.log(3)"})," \u8f93\u51fa 3"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"console.log(7)"})," \u8f93\u51fa 7"]}),"\n",(0,c.jsxs)(e.li,{children:["\u8bbe\u7f6e\u4e00\u4e2a ",(0,c.jsx)(e.code,{children:"setTimeout"}),"\uff0c\u5c06 ",(0,c.jsx)(e.code,{children:"console.log(5)"})," \u548c ",(0,c.jsx)(e.code,{children:"resolve(6)"})," \u653e\u5165\u5f02\u6b65\u4efb\u52a1\u961f\u5217"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"resolve(1)"})," \u7acb\u5373\u6267\u884c\uff0c\u968f\u540e ",(0,c.jsx)(e.code,{children:"resolve(2)"})," \u4e5f\u7acb\u5373\u6267\u884c"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"console.log(4)"})," \u8f93\u51fa 4"]}),"\n",(0,c.jsxs)(e.li,{children:["\u5fae\u4efb\u52a1\u961f\u5217\u4e2d\u7684 ",(0,c.jsx)(e.code,{children:"p.then"})," \u5148\u6267\u884c\uff0c\u8f93\u51fa 1"]}),"\n",(0,c.jsxs)(e.li,{children:["\u6700\u540e\uff0c",(0,c.jsx)(e.code,{children:"first().then"})," \u6267\u884c\uff0c\u8f93\u51fa 2"]}),"\n",(0,c.jsxs)(e.li,{children:["\u5f02\u6b65\u4efb\u52a1\u4e2d\u7684 ",(0,c.jsx)(e.code,{children:"console.log(5)"})," \u8f93\u51fa 5\uff0c\u968f\u540e ",(0,c.jsx)(e.code,{children:"console.log(p)"})," \u8f93\u51fa ",(0,c.jsx)(e.code,{children:"fulfilled"})]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"\u5fae\u4efb\u52a1",children:"\u5fae\u4efb\u52a1"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"let a;\nconst b = new Promise((resolve, reject) => {\n  console.log('promise1'); // \u540c\u6b651 promise1\n  resolve();\n})\n  .then(() => {\n    console.log('promise2'); // \u5fae1 promise2\n  })\n  .then(() => {\n    console.log('promise3'); // \u5fae2 promise3\n  })\n  .then(() => {\n    console.log('promise4'); // \u5fae3 promise4\n  });\n\na = new Promise(async (resolve, reject) => {\n  console.log(a); // \u540c\u6b652 undefined\n  console.log(b); // Promise\xa0fulfilled\n  await b; // \u7b49\u5f85b\u6267\u884c\u7ed3\u675f\u540e\uff0c\u4ee3\u7801\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\n  console.log(a); // \u5728\u7b49\u5f85b\u7684\u65f6\u5019 new Promise\u5df2\u7ecf\u5b8c\u6210\uff0cpromise pending\n  console.log('after1'); // after1\n  await a; // \u7b49\u5f85a\u7684\u5904\u7406\u7ed3\u679c\uff0ca \u7684\u7ed3\u679c\u5728await\u4e4b\u540e\uff0c\u6240\u4ee5\u4f1a\u4e00\u76f4\u7b49\u5f85\n  resolve(true);\n  console.log('after2');\n});\nconsole.log('end'); // \u540c\u6b653 end\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u6b64\u4ee3\u7801\u5c55\u793a\u4e86\u5fae\u4efb\u52a1\u7684\u6267\u884c\u987a\u5e8f\uff1a"}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"promise1"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"undefined"})," \u548c ",(0,c.jsx)(e.code,{children:"Promise\xa0fulfilled"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"end"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5fae\u4efb\u52a1\u961f\u5217\u4f9d\u6b21\u6267\u884c\uff0c\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"promise2"}),"\u3001",(0,c.jsx)(e.code,{children:"promise3"}),"\u3001",(0,c.jsx)(e.code,{children:"promise4"})]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"await b"})," \u5b8c\u6210\u540e\uff0c\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"after1"})]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"await a"})," \u56e0\u4e3a ",(0,c.jsx)(e.code,{children:"a"})," \u5904\u4e8e pending \u72b6\u6001\uff0c\u540e\u7eed\u4ee3\u7801\u6682\u505c\u6267\u884c"]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"promiseall",children:"Promise.all"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"function runAsync(x) {\n  const p = new Promise((resolve) => {\n    setTimeout(() => {\n      resolve(x, console.log(x));\n    }, 1000);\n  });\n  return p;\n}\n\nfunction runReject(x) {\n  const p = new Promise((res, rej) => {\n    setTimeout(() => {\n      rej(`Error:${x}`, console.log(x));\n    }, 1000 * x);\n  });\n  return p;\n}\n\n// \u6240\u6709\u7684Promise\u90fd\u6210\u529f\u4e86\uff0cres\u624d\u4f1a\u6253\u5370\u6210\u529f\u7684\u503c\nPromise.all([runAsync(1), runReject(4), runAsync(3), runReject(2)])\n  // 13 \u4e00\u8d77\u51fa\u73b0\uff0c\u56e0\u4e3a\u65f6\u95f4\u4e00\u6837\uff0c\u51482\u540e4\uff0c2\u7684\u9519\u8bef\u5148\u5230\uff0c\u6253\u5370\u9519\u8bef2\n  .then((res) => console.log(res))\n  .catch((err) => console.log(err));\n"})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"Promise.all"})," \u4f1a\u7b49\u5f85\u6240\u6709\u7684 Promise \u5b8c\u6210\u3002\u5982\u679c\u6709\u4efb\u610f\u4e00\u4e2a Promise \u5931\u8d25\uff0c",(0,c.jsx)(e.code,{children:"Promise.all"})," \u4f1a\u7acb\u5373\u8fdb\u5165 ",(0,c.jsx)(e.code,{children:"catch"}),"\uff0c\u8f93\u51fa\u7b2c\u4e00\u4e2a\u5931\u8d25\u7684\u9519\u8bef\u3002\u5728\u6b64\u4f8b\u4e2d\uff0c",(0,c.jsx)(e.code,{children:"runReject(2)"})," \u4f1a\u5728 2000ms \u540e\u5148\u4e8e ",(0,c.jsx)(e.code,{children:"runReject(4)"})," \u62a5\u9519\uff0c\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"Error:2"}),"\u3002"]}),"\n",(0,c.jsx)(e.h2,{id:"promiserace",children:"Promise.race"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"function runAsync(x) {\n  const p = new Promise((r) => {\n    setTimeout(() => r(x, console.log(x)), 1000);\n  });\n  return p;\n}\n// 123\u4e00\u8d77\u6267\u884c\uff0c\u542f\u52a8\u4e09\u4e2a\u5b9a\u65f6\u5668\uff0c123\u90fd\u4f1a\u6253\u5370\uff0c1\u6700\u5148\u8fd4\u56de\u6210\u529f\nPromise.race([runAsync(1), runAsync(2), runAsync(3)])\n  // res\u7684\u7ed3\u679c\uff0c\u63a5\u6536\u8fd4\u56de\u6700\u5feb\u7684\u503c\n  .then((res) => console.log('result:', res))\n  .catch((err) => console.log(err));\n"})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"Promise.race"})," \u4f1a\u5728\u7b2c\u4e00\u4e2a Promise \u5b8c\u6210\u6216\u5931\u8d25\u65f6\u7acb\u5373\u8fd4\u56de\u7ed3\u679c\u3002\u5728\u6b64\u4f8b\u4e2d\uff0c",(0,c.jsx)(e.code,{children:"runAsync(1)"})," \u6700\u5148\u5b8c\u6210\uff0c\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"1"})," \u5e76\u4e14 ",(0,c.jsx)(e.code,{children:"then"})," \u4e2d\u7684\u56de\u8c03\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"result: 1"}),"\u3002"]}),"\n",(0,c.jsx)(e.h2,{id:"async",children:"async"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"async function async1() {\n  // async\u6ca1\u6709await\uff0c\u5269\u4e0b\u7684\u4ee3\u7801\u90fd\u662f\u540c\u6b65\u4ee3\u7801\n  console.log('1'); // \u540c\u6b651\n  // promise \u7684\u53c2\u6570\u662f\u4e2a\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u662f\u540c\u6b65\u6267\u884c\u7684\n  new Promise((resolve) => {\n    // \u76f4\u63a5\u6267\u884c\n    resolve();\n    console.log('2'); // \u540c\u6b65 2\n  });\n  console.log('3'); // \u540c\u6b653\n}\nasync1();\nconsole.log('4'); // \u540c\u6b654\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u5728\u6ca1\u6709 ",(0,c.jsx)(e.code,{children:"await"})," \u7684\u60c5\u51b5\u4e0b\uff0c",(0,c.jsx)(e.code,{children:"async"})," \u51fd\u6570\u4e2d\u7684\u4ee3\u7801\u540c\u6b65\u6267\u884c\uff0c\u8f93\u51fa\u987a\u5e8f\u4e3a ",(0,c.jsx)(e.code,{children:"1"}),"\u3001",(0,c.jsx)(e.code,{children:"2"}),"\u3001",(0,c.jsx)(e.code,{children:"3"}),"\u3001",(0,c.jsx)(e.code,{children:"4"}),"\u3002"]}),"\n",(0,c.jsx)(e.h2,{id:"await",children:"await"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"async function async1() {\n  console.log('1'); // \u540c\u6b651\n  await async2(); // \u7b49\u5f85 async2 \u6267\u884c\u5b8c\uff0c\u5305\u62ec\u91cc\u9762\u7684\u5f02\u6b65\n  console.log('2'); // \u5fae\u4efb\u52a11\n}\nasync function async2() {\n  setTimeout(() => {\n    console.log('3'); // \u5f02\u6b65 1\n  }, 0);\n  console.log('4'); // \u540c\u6b652\n}\nasync1();\nconsole.log(5); // \u540c\u6b654\n"})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"await"})," \u4f1a\u6682\u505c ",(0,c.jsx)(e.code,{children:"async"})," \u51fd\u6570\u7684\u6267\u884c\uff0c\u7b49\u5f85 Promise \u5b8c\u6210\u540e\u7ee7\u7eed\u3002\u8f93\u51fa\u987a\u5e8f\u4e3a ",(0,c.jsx)(e.code,{children:"1"}),"\u3001",(0,c.jsx)(e.code,{children:"4"}),"\u3001",(0,c.jsx)(e.code,{children:"5"}),"\u3001",(0,c.jsx)(e.code,{children:"2"}),"\u3001",(0,c.jsx)(e.code,{children:"3"}),"\u3002"]}),"\n",(0,c.jsx)(e.h2,{id:"\u5f02\u6b65\u4efb\u52a1",children:"\u5f02\u6b65\u4efb\u52a1"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"async function async1() {\n  console.log(1); // \u540c\u6b651\n  await async2(); // \u7b49\u5f85async2()\n  /* \u5fae\u4efb\u52a1\u533a\u57df */\n  console.log(2); // async2\u4e86\u5c31\u6267\u884c\n  setTimeout(() => {\n    console.log(3); // \u5f02\u6b653\n  }, 0);\n  /* \u5fae\u4efb\u52a1\u533a\u57df */\n}\nasync function async2() {\n  // \u6700\u5148\u6ce8\u518c\u7684\u8ba1\u65f6\u5668\n  setTimeout(() => {\n    console.log(4); // \u5f02\u6b651\n  }, 0);\n  console.log(5); // \u540c\u6b652\n}\n\nasync1(); // \u4ece\u8fd9\u91cc\u5f00\u59cb\u6267\u884c\n// async1();\u5361\u4f4f\u4e86\u5c31\u7ee7\u7eed\u6267\u884c\u5f53\u524d\u5b8f\u4efb\u52a1\nsetTimeout(() => {\n  console.log(6); // \u5f02\u6b652\n}, 0);\nconsole.log(7); // \u540c\u6b653\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u6267\u884c\u987a\u5e8f\uff1a"}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"1"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"5"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"7"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5fae\u4efb\u52a1\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"2"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5f02\u6b65\u4efb\u52a1\u6309\u6ce8\u518c\u987a\u5e8f\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"4"}),"\u3001",(0,c.jsx)(e.code,{children:"3"}),"\u3001",(0,c.jsx)(e.code,{children:"6"})]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"pending",children:"pending"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"async function async1() {\n  console.log('1'); // \u540c\u6b65 2\n  /* \u8fd9\u91cc\u7684 Promise \u662f pending \u72b6\u6001\u6240\u4ee5\u4e0b\u9762\u7684\u4ee3\u7801\u4e0d\u56de\u6267\u884c */\n  await new Promise((resolve) => {\n    console.log('2'); // \u540c\u6b653 \u56e0\u4e3a\u662f\u5728\u62ec\u53f7\u91cc\u7684\n  });\n\n  /* \u2193\u662f\u5fae\u4efb\u52a1 */\n  console.log('3');\n  return '4';\n}\nconsole.log('5'); // \u540c\u6b651\nasync1().then((res) => console.log(res));\nconsole.log('6'); // \u540c\u6b65 4\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u7531\u4e8e ",(0,c.jsx)(e.code,{children:"new Promise"})," \u4e2d\u6ca1\u6709\u8c03\u7528 ",(0,c.jsx)(e.code,{children:"resolve"}),"\uff0cPromise \u59cb\u7ec8\u5904\u4e8e pending \u72b6\u6001\uff0c\u5bfc\u81f4 ",(0,c.jsx)(e.code,{children:"await"})," \u540e\u7684\u4ee3\u7801\u4e0d\u4f1a\u6267\u884c\u3002\u8f93\u51fa\u987a\u5e8f\u4e3a ",(0,c.jsx)(e.code,{children:"5"}),"\u3001",(0,c.jsx)(e.code,{children:"1"}),"\u3001",(0,c.jsx)(e.code,{children:"2"}),"\u3001",(0,c.jsx)(e.code,{children:"6"}),"\u3002"]}),"\n",(0,c.jsx)(e.h2,{id:"await-\u4e0e\u5fae\u4efb\u52a1",children:"await \u4e0e\u5fae\u4efb\u52a1"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"async function async1() {\n  console.log('1'); // \u540c\u6b652\n  await new Promise((resolve) => {\n    console.log('2'); // \u540c\u6b653\n    resolve('3');\n    // \u7ee7\u7eed\u6309\u7167\u4ee3\u7801\u987a\u5e8f\u6267\u884c\n  }).then((res) => console.log(res)); // \u5fae1\n  console.log('4'); // \u5fae2\n  return '5';\n}\nconsole.log('6'); // \u540c\u6b651\nasync1().then((res) => console.log(res)); // \u5fae3\nconsole.log('7'); // \u540c\u6b654\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u6267\u884c\u987a\u5e8f\uff1a"}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"6"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"1"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"2"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"7"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5fae\u4efb\u52a1\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"3"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5fae\u4efb\u52a1\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"4"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5fae\u4efb\u52a1\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"5"})]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"\u5fae\u4efb\u52a1\u6267\u884c",children:"\u5fae\u4efb\u52a1\u6267\u884c"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"async function async1() {\n  console.log(1); // \u540c\u6b652\n  await new Promise((resolve) => {\n    console.log(2); // \u540c\u6b653\n    resolve(3);\n  });\n  // \u9760\u524d\u9762\u7684\u5fae\u4efb\u52a1\u5148\u6267\u884c\n  console.log(4); // \u5fae1\n  return 5;\n}\nconsole.log(6); // \u540c\u6b651\n// \u63a5\u6536resolve\uff083\uff09\nasync1().then((res) => {\n  console.log(res); // \u5fae2\n});\nnew Promise((resolve) => {\n  console.log(7); // \u540c\u6b65 4\n  setTimeout(() => {\n    console.log(8); // \u5f02\u6b651\n  }, 0);\n});\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u8f93\u51fa\u987a\u5e8f\uff1a"}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"6"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"1"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"2"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"7"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5fae\u4efb\u52a1\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"4"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5fae\u4efb\u52a1\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"5"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5f02\u6b65\u4efb\u52a1\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"8"})]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"\u591a\u4e2a\u5fae\u4efb\u52a1",children:"\u591a\u4e2a\u5fae\u4efb\u52a1"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"async function testSomething() {\n  console.log('1'); // \u540c\u6b65 2\n  return '2'; // \u8fd4\u56de\u7684\u662f\u5305\u88c5\u540e\u7684promise \u5c5e\u4e8e\u5fae\u4efb\u52a1\n}\n\nasync function testAsync() {\n  console.log('3'); // \u5fae\u4efb\u52a1 \u7684\u540c\u6b65\u4efb\u52a11\n  return Promise.resolve('4');\n}\n\nasync function test() {\n  console.log('5'); // \u540c\u6b651\n  // v1\u7b2c\u4e00\u4e2a\u5148\u6ce8\u518c\u7684\u5fae\u4efb\u52a1\u56de\u8c03\n  const v1 = await testSomething();\n  console.log(v1); // \u5fae1\n  // v2 \u8981\u7b49\u5f85 v1 \u7684\u7ed3\u679c\uff0cv2 \u4efb\u52a1\u5728v1\u540e\u6267\u884c\n  const v2 = await testAsync();\n  console.log(v2); // \u5fae3\n  console.log(v1, v2); // \u5fae4\n}\ntest();\nlet promise = new Promise((resolve) => {\n  console.log('6'); // \u540c\u6b65 3\n  resolve('7'); // \u5fae\u4efb\u52a1 2\n});\n// \u7b2c\u4e8c\u4e2a\u6ce8\u518c\u7684\u5fae\u4efb\u52a1\npromise.then((val) => console.log(val)); // \u5fae2 \u7ed3\u679c\nconsole.log('8'); // \u540c\u6b65 4\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u6267\u884c\u987a\u5e8f\uff1a"}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"5"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"1"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"6"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"3"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"8"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5fae\u4efb\u52a1\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"2"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5fae\u4efb\u52a1\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"7"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u5fae\u4efb\u52a1\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"4"})]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"reject",children:"reject"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"async function async1() {\n  await async2(); // \u63a5\u6536\u5230reject\uff0c\u4e0d\u7ee7\u7eed\u6267\u884c\n  console.log('1');\n  return '2';\n}\n\nasync function async2() {\n  return new Promise((resolve, reject) => {\n    console.log('3'); // \u540c\u6b651\n    reject('4');\n  });\n}\n// \u6210\u529f\u4e4b\u540e\u624d\u4f1a\u6267\u884c\uff0c\u6240\u4ee5\u4f1a\u62a5\u9519\nasync1()\n  .then((res) => console.log(res))\n  .catch((err) => {\n    console.log(err); // \u6355\u83b7\u9519\u8bef4\n  });\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u5728 ",(0,c.jsx)(e.code,{children:"async2"})," \u4e2d\u8c03\u7528 ",(0,c.jsx)(e.code,{children:"reject"}),"\uff0c\u5bfc\u81f4 ",(0,c.jsx)(e.code,{children:"async1"})," \u4e2d\u7684 ",(0,c.jsx)(e.code,{children:"await"})," \u6355\u83b7\u5230\u9519\u8bef\uff0c\u8fdb\u5165 ",(0,c.jsx)(e.code,{children:"catch"}),"\uff0c\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"4"}),"\u3002"]}),"\n",(0,c.jsx)(e.h2,{id:"trycatch",children:"try...catch"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"async function async1() {\n  try {\n    await Promise.reject('1');\n  } catch (e) {\n    console.log(2); // 1 \u6355\u83b7\u9519\u8bef\u7ee7\u7eed\u6267\u884c\n  }\n  console.log(3); // 2\n  return Promise.resolve('4');\n}\n\nasync1().then((res) => console.log(res)); // 3\nconsole.log('5'); // \u540c\u6b651\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u901a\u8fc7 ",(0,c.jsx)(e.code,{children:"try...catch"})," \u6355\u83b7 ",(0,c.jsx)(e.code,{children:"Promise"})," \u7684\u62d2\u7edd\uff0c\u4ee3\u7801\u7ee7\u7eed\u6267\u884c\u3002\u8f93\u51fa\u987a\u5e8f\u4e3a ",(0,c.jsx)(e.code,{children:"5"}),"\u3001",(0,c.jsx)(e.code,{children:"2"}),"\u3001",(0,c.jsx)(e.code,{children:"3"}),"\u3001",(0,c.jsx)(e.code,{children:"4"}),"\u3002"]}),"\n",(0,c.jsx)(e.h2,{id:"\u7efc\u5408\u793a\u4f8b",children:"\u7efc\u5408\u793a\u4f8b"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"const async1 = async () => {\n  console.log('1'); // \u540c\u6b652\n\n  setTimeout(() => {\n    console.log('2'); // \u5f02\u6b652\n  }, 2000);\n  await new Promise((resolve) => {\n    console.log(3); // \u540c\u6b653\n  });\n  // \u5fae\u4efb\u52a1\u65e0\u72b6\u6001\uff0c\u540e\u7eed\u4ee3\u7801\u4e0d\u6267\u884c\n  console.log(4);\n  return 5;\n};\n\nconsole.log('6'); // \u540c\u6b651\nasync1().then((res) => console.log(res)); // \u4e00\u76f4\u7b49\u5f85Promise\u7684\u503c\nconsole.log(7); // \u540c\u6b654\n\n// Promise\nPromise.resolve(1)\n  // .then\u5fc5\u987b\u63a5\u6536\u7684\u662f\u51fd\u6570\uff0c\u5ffd\u7565\n  .then(2)\n  // \u5ffd\u7565\n  .then(Promise.resolve(3))\n  // \u5ffd\u7565\n  .catch(4)\n  .then((res) => console.log(res)); // \u5fae1 1\n\nsetTimeout(() => {\n  console.log(8); // \u5f02\u6b651\n}, 1000);\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u5728\u8fd9\u4e2a\u7efc\u5408\u793a\u4f8b\u4e2d\uff0c\u5c55\u793a\u4e86 ",(0,c.jsx)(e.code,{children:"async/await"})," \u4e0e ",(0,c.jsx)(e.code,{children:"Promise"})," \u7684\u590d\u6742\u4ea4\u4e92\u3002\u8f93\u51fa\u987a\u5e8f\u4e3a\uff1a"]}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"6"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"1"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"3"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"7"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"1"}),"\uff08\u6765\u81ea ",(0,c.jsx)(e.code,{children:"Promise.resolve(1)"})," \u7684\u5fae\u4efb\u52a1\uff09"]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"5"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"8"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"2"}),"\uff08\u4e24\u79d2\u540e\uff09"]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"4"})]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"finally",children:"finally"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"const p1 = new Promise((resolve) => {\n  setTimeout(() => {\n    resolve(1);\n    console.log(2); // 3 2\n  }, 0);\n  resolve(3);\n  resolve(4);\n})\n  .then((res) => {\n    console.log(res); // 1  3\n    setTimeout(() => {\n      console.log(p1); //4 Promise fulfilled\n    }, 1000);\n  })\n  .finally((res) => {\n    // \u56e0\u4e3a\u524d\u4e00\u4e2a.then\u6ca1\u6709resolved \u6216 rejected \u8fd4\u56de undefined\n    console.log('finally', res); // 2 finally undefined\n  });\n"})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"finally"})," \u65e0\u8bba Promise \u6700\u7ec8\u72b6\u6001\u5982\u4f55\uff0c\u90fd\u4f1a\u6267\u884c\u3002\u5728\u6b64\u4f8b\u4e2d\uff0c\u8f93\u51fa\u987a\u5e8f\u4e3a\uff1a"]}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"3"}),"\uff08",(0,c.jsx)(e.code,{children:"resolve(3)"})," \u4f18\u5148\u4e8e ",(0,c.jsx)(e.code,{children:"resolve(4)"}),")"]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"finally undefined"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"1"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"2"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u4e00\u79d2\u540e\u8f93\u51fa ",(0,c.jsx)(e.code,{children:"Promise { <fulfilled>: 3 }"})]}),"\n"]})]})}function t(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(h,{...n})}):h(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>r,x:()=>i});var l=s(96540);const c={},o=l.createContext(c);function r(n){const e=l.useContext(o);return l.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:r(n.components),l.createElement(o.Provider,{value:e},n.children)}}}]);